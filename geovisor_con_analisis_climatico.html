<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Incendios forestales en Costa Rica</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="geovisor_con_analisis_climatico_files/libs/clipboard/clipboard.min.js"></script>
<script src="geovisor_con_analisis_climatico_files/libs/quarto-html/quarto.js"></script>
<script src="geovisor_con_analisis_climatico_files/libs/quarto-html/popper.min.js"></script>
<script src="geovisor_con_analisis_climatico_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="geovisor_con_analisis_climatico_files/libs/quarto-html/anchor.min.js"></script>
<link href="geovisor_con_analisis_climatico_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="geovisor_con_analisis_climatico_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="geovisor_con_analisis_climatico_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="geovisor_con_analisis_climatico_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="geovisor_con_analisis_climatico_files/libs/bootstrap/bootstrap-a2e559454ce866cd6b9e7d38c141fb07.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="geovisor_con_analisis_climatico_files/libs/quarto-dashboard/quarto-dashboard.js"></script>
<script src="geovisor_con_analisis_climatico_files/libs/quarto-dashboard/stickythead.js"></script>
<script src="geovisor_con_analisis_climatico_files/libs/quarto-dashboard/datatables.min.js" kdttablesentinel="true"></script>
<script src="geovisor_con_analisis_climatico_files/libs/quarto-dashboard/pdfmake.min.js" kdttablesentinel="true"></script>
<script src="geovisor_con_analisis_climatico_files/libs/quarto-dashboard/vfs_fonts.js" kdttablesentinel="true"></script>
<script src="geovisor_con_analisis_climatico_files/libs/quarto-dashboard/web-components.js" type="module"></script>
<script src="geovisor_con_analisis_climatico_files/libs/quarto-dashboard/components.js"></script>
<link href="geovisor_con_analisis_climatico_files/libs/quarto-dashboard/datatables.min.css" rel="stylesheet" kdttablesentinel="true">


</head>

<body class="quarto-dashboard dashboard-fill dashboard-sidebar fullcontent">

<header id="quarto-dashboard-header">
<nav class="navbar navbar-expand-md slim" data-bs-theme="dark">
  <div class="navbar-container container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-controls="dashboard-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>    


    <div class="navbar-brand-container">       

      <div class="navbar-title">
        <div class="navbar-title-text"><a href="#">Incendios forestales en Costa Rica</a></div>
        
        
      </div>
    </div>
<div id="dashboard-collapse" class="navbar-collapse collapse"><ul class="navbar-nav navbar-nav-scroll me-auto" role="tablist"><li class="nav-item" role="presentation"><a id="tab-análisis-espacial" class="nav-link active" data-bs-toggle="tab" role="tab" data-bs-target="#análisis-espacial" data-scrolling="false" href="#análisis-espacial" aria-controls="análisis-espacial" aria-selected="true"><span class="nav-link-text">Análisis espacial</span></a></li><li class="nav-item" role="presentation"><a id="tab-análisis-temporal" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#análisis-temporal" data-scrolling="false" href="#análisis-temporal" aria-controls="análisis-temporal" aria-selected="false"><span class="nav-link-text">Análisis temporal</span></a></li><li class="nav-item" role="presentation"><a id="tab-registros-de-incendios" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#registros-de-incendios" data-scrolling="false" href="#registros-de-incendios" aria-controls="registros-de-incendios" aria-selected="false"><span class="nav-link-text">Registros de incendios</span></a></li><li class="nav-item" role="presentation"><a id="tab-análisis-de-temperatura" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#análisis-de-temperatura" data-scrolling="false" href="#análisis-de-temperatura" aria-controls="análisis-de-temperatura" aria-selected="false"><span class="nav-link-text">Análisis de temperatura</span></a></li><li class="nav-item" role="presentation"><a id="tab-análisis-de-precipitación" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#análisis-de-precipitación" data-scrolling="false" href="#análisis-de-precipitación" aria-controls="análisis-de-precipitación" aria-selected="false"><span class="nav-link-text">Análisis de precipitación</span></a></li><li class="nav-item" role="presentation"><a id="tab-análisis-de-velocidad-del-viento" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#análisis-de-velocidad-del-viento" data-scrolling="false" href="#análisis-de-velocidad-del-viento" aria-controls="análisis-de-velocidad-del-viento" aria-selected="false"><span class="nav-link-text">Análisis de velocidad del viento</span></a></li><li class="nav-item" role="presentation"><a id="tab-análisis-de-dirección-del-viento" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#análisis-de-dirección-del-viento" data-scrolling="false" href="#análisis-de-dirección-del-viento" aria-controls="análisis-de-dirección-del-viento" aria-selected="false"><span class="nav-link-text">Análisis de dirección del viento</span></a></li><li class="nav-item" role="presentation"><a id="tab-análisis-integrado" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#análisis-integrado" data-scrolling="false" href="#análisis-integrado" aria-controls="análisis-integrado" aria-selected="false"><span class="nav-link-text">Análisis integrado</span></a></li></ul></div></div>
</nav>
</header>
<div class="page-layout-custom quarto-dashboard-content bslib-gap-spacing html-fill-container bslib-page-fill quarto-dashboard-pages dashboard-sidebar-container">  

<div class="bslib-sidebar-layout html-fill-item html-fill-container" data-bslib-sidebar-open="desktop" data-bslib-sidebar-init="true" style=" --bslib-sidebar-width: 15%" data-bslib-sidebar-border="false" data-bslib-sidebar-border-radius="false"><div class="main html-fill-container html-fill-item"><div class="sidebar-content html-fill-item html-fill-container">
<div class="tab-content bslib-grid html-fill-item html-fill-container" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div id="análisis-espacial" class="dashboard-page tab-pane show active html-fill-item html-fill-container" data-orientation="columns" aria-labelledby="tab-análisis-espacial">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 75fr) minmax(3em, 25fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Distribución de incendios en Áreas de Conservación (AC) y Áreas Silvestres Protegidas (ASP)" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Distribución de incendios en Áreas de Conservación (AC) y Áreas Silvestres Protegidas (ASP)
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="leaflet html-widget html-widget-output shiny-report-size html-fill-item html-fill-container" id="mapa" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr) minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Cantidad de incendios en AC" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Cantidad de incendios en AC
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_cantidad_incendios_ac" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Cantidad de incendios en ASP" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Cantidad de incendios en ASP
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_cantidad_incendios_asp" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div><div id="análisis-temporal" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="columns" aria-labelledby="tab-análisis-temporal">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Cantidad de incendios por año" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Cantidad de incendios por año
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_cantidad_incendios_anio" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Cantidad de incendios por año y mes" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Cantidad de incendios por año y mes
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_cantidad_incendios_anio_mes" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div><div id="registros-de-incendios" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="columns" aria-labelledby="tab-registros-de-incendios">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Registros de incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Registros de incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="datatables html-widget html-widget-output shiny-report-size html-fill-item html-fill-container" id="tabla_registros_incendios" style="width:100%;height:auto;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div><div id="análisis-de-temperatura" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="columns" aria-labelledby="tab-análisis-de-temperatura">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 20fr) minmax(3em, 80fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 25fr) minmax(3em, 25fr) minmax(3em, 25fr) minmax(3em, 25fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Tendencia de temperatura" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Tendencia de temperatura
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_tendencia_temp" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Tendencia de incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Tendencia de incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_tendencia_incendios" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Correlación Temp-Incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Correlación Temp-Incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_correlacion" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Cambio 2013-24 vs 2001-12" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Cambio 2013-24 vs 2001-12
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_cambio_periodo" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 50fr) minmax(3em, 50fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Tendencias de temperatura e incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Tendencias de temperatura e incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_tendencias_duales" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Correlación temperatura - incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Correlación temperatura - incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_correlacion" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Comparación entre períodos (2001-2012 vs 2013-2024)" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Comparación entre períodos (2001-2012 vs 2013-2024)
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_comparacion_periodos" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Anomalías de temperatura y cantidad de incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Anomalías de temperatura y cantidad de incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_anomalias" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div>
</div><div id="análisis-de-precipitación" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="columns" aria-labelledby="tab-análisis-de-precipitación">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 20fr) minmax(3em, 80fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 25fr) minmax(3em, 25fr) minmax(3em, 25fr) minmax(3em, 25fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Tendencia de precipitación" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Tendencia de precipitación
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_tendencia_precip" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Tendencia de incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Tendencia de incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_tendencia_incendios_precip" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Correlación Precip-Incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Correlación Precip-Incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_correlacion_precip" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Cambio 2013-24 vs 2001-12" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Cambio 2013-24 vs 2001-12
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_cambio_periodo_precip" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 50fr) minmax(3em, 50fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Tendencias de precipitación e incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Tendencias de precipitación e incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_tendencias_precip" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Correlación precipitación - incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Correlación precipitación - incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_correlacion_precip" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Comparación entre períodos (2001-2012 vs 2013-2024)" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Comparación entre períodos (2001-2012 vs 2013-2024)
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_comparacion_periodos_precip" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Anomalías de precipitación y cantidad de incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Anomalías de precipitación y cantidad de incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_anomalias_precip" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div>
</div><div id="análisis-de-velocidad-del-viento" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="columns" aria-labelledby="tab-análisis-de-velocidad-del-viento">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 20fr) minmax(3em, 80fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 25fr) minmax(3em, 25fr) minmax(3em, 25fr) minmax(3em, 25fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Tendencia de viento" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Tendencia de viento
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_tendencia_viento" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Tendencia de incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Tendencia de incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_tendencia_incendios_viento" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Correlación Viento-Incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Correlación Viento-Incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_correlacion_viento" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Cambio 2013-24 vs 2001-12" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Cambio 2013-24 vs 2001-12
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_cambio_periodo_viento" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 50fr) minmax(3em, 50fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Tendencias de velocidad del viento e incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Tendencias de velocidad del viento e incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_tendencias_viento" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Correlación velocidad del viento - incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Correlación velocidad del viento - incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_correlacion_viento" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Comparación entre períodos (2001-2012 vs 2013-2024)" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Comparación entre períodos (2001-2012 vs 2013-2024)
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_comparacion_periodos_viento" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Anomalías de velocidad del viento y cantidad de incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Anomalías de velocidad del viento y cantidad de incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_anomalias_viento" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div>
</div><div id="análisis-de-dirección-del-viento" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="columns" aria-labelledby="tab-análisis-de-dirección-del-viento">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 20fr) minmax(3em, 80fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 25fr) minmax(3em, 25fr) minmax(3em, 25fr) minmax(3em, 25fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Dirección predominante" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Dirección predominante
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_direccion_predominante" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Tendencia de incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Tendencia de incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_tendencia_incendios_direccion" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Variabilidad de dirección" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Variabilidad de dirección
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_variabilidad_direccion" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Cambio 2013-24 vs 2001-12" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Cambio 2013-24 vs 2001-12
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_cambio_periodo_direccion" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 50fr) minmax(3em, 50fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Rosa de vientos e incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Rosa de vientos e incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_rosa_vientos" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Dirección del viento vs incendios por sector" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Dirección del viento vs incendios por sector
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_direccion_incendios" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Dirección del viento promedio por año" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Dirección del viento promedio por año
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_direccion_temporal" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Dirección del viento e incendios por mes" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Dirección del viento e incendios por mes
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_direccion_mensual" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div>
</div><div id="análisis-integrado" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="columns" aria-labelledby="tab-análisis-integrado">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 20fr) minmax(3em, 80fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 20fr) minmax(3em, 20fr) minmax(3em, 20fr) minmax(3em, 20fr) minmax(3em, 20fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Temperatura" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Temperatura
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_resumen_temp" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Precipitación" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Precipitación
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_resumen_precip" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Viento" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Viento
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_resumen_viento" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Incendios" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Incendios
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_resumen_incendios" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Correlación más fuerte" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Correlación más fuerte
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="card_correlacion_maxima" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 50fr) minmax(3em, 50fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Matriz de correlación entre variables" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Matriz de correlación entre variables
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_matriz_correlacion" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Interacción temperatura × precipitación" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Interacción temperatura × precipitación
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_interaccion_temp_precip" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Tendencias normalizadas de todas las variables" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Tendencias normalizadas de todas las variables
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_tendencias_multiples" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-title="Clasificación de años por condiciones de riesgo" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">
Clasificación de años por condiciones de riesgo
</span></div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container" id="grafico_condiciones_riesgo" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div id="3ade8a4a-fb1d-4a6c-8409-ac45482d5fc9" class="hidden html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
</div>
</div>
</div></div><aside id="bslib-sidebar-1" class="sidebar html-fill-container html-fill-item"><div class="html-fill-container html-fill-item">
<div class="cell-output-display">
<div class="form-group shiny-input-container no-baseline">
<label class="control-label" id="confianza_minima-label" for="confianza_minima">Confianza mínima</label>
<input class="js-range-slider" id="confianza_minima" data-skin="shiny" data-min="80" data-max="100" data-from="80" data-step="1" data-grid="true" data-grid-num="10" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container no-baseline">
<label class="control-label" id="frp-label" for="frp">Potencia radiativa del fuego - FRP (MW)</label>
<input class="js-range-slider" id="frp" data-skin="shiny" data-type="double" data-min="6.6" data-max="859.8" data-from="6.6" data-to="859.8" data-step="1" data-grid="true" data-grid-num="9.92093023255814" data-grid-snap="false" data-prettify-separator="" data-prettify-enabled="false" data-keyboard="true" data-drag-interval="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display">
<div id="fecha" class="shiny-date-range-input form-group shiny-input-container">
<label class="control-label" id="fecha-label" for="fecha">Fecha</label>
<div class="input-daterange input-group input-group-sm">
<input class="form-control" type="text" aria-labelledby="fecha-label" title="Date format: yyyy-mm-dd" data-date-language="es" data-date-week-start="1" data-date-format="yyyy-mm-dd" data-date-start-view="month" data-min-date="2001-01-04" data-max-date="2024-12-19" data-initial-date="2001-01-04" data-date-autoclose="true">
<span class="input-group-addon input-group-prepend input-group-append">
<span class="input-group-text"> to </span>
</span>
<input class="form-control" type="text" aria-labelledby="fecha-label" title="Date format: yyyy-mm-dd" data-date-language="es" data-date-week-start="1" data-date-format="yyyy-mm-dd" data-date-start-view="month" data-min-date="2001-01-04" data-max-date="2024-12-19" data-initial-date="2024-12-19" data-date-autoclose="true">
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="ac-label" for="ac">Área de Conservación (AC)</label>
<div>
<select id="ac" class="shiny-input-select"><option value="Todas" selected="">Todas</option>
<option value="Arenal Tempisque">Arenal Tempisque</option>
<option value="Central">Central</option>
<option value="Guanacaste">Guanacaste</option>
<option value="Huetar Norte">Huetar Norte</option>
<option value="La Amistad Caribe">La Amistad Caribe</option>
<option value="La Amistad Pacifico">La Amistad Pacifico</option>
<option value="Osa">Osa</option>
<option value="Pacifico Central">Pacifico Central</option>
<option value="Tempisque">Tempisque</option>
<option value="Tortuguero">Tortuguero</option></select>
<script type="application/json" data-for="ac" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="asp-label" for="asp">Área Silvestre Protegida (ASP)</label>
<div>
<select id="asp" class="shiny-input-select"><option value="Todas" selected="">Todas</option>
<option value="HH Estero Puntarenas">HH Estero Puntarenas</option>
<option value="HH Humedal Laguna Madrigal">HH Humedal Laguna Madrigal</option>
<option value="HH Palustrino Corral de piedra">HH Palustrino Corral de piedra</option>
<option value="HH Riberino Zapandi">HH Riberino Zapandi</option>
<option value="HH Rio Canas">HH Rio Canas</option>
<option value="HH Terraba-Sierpe">HH Terraba-Sierpe</option>
<option value="PN Arenal">PN Arenal</option>
<option value="PN Barra Honda">PN Barra Honda</option>
<option value="PN Carara">PN Carara</option>
<option value="PN Diria">PN Diria</option>
<option value="PN Guanacaste">PN Guanacaste</option>
<option value="PN Internacional La Amistad">PN Internacional La Amistad</option>
<option value="PN Los Santos">PN Los Santos</option>
<option value="PN Palo Verde">PN Palo Verde</option>
<option value="PN Santa Rosa">PN Santa Rosa</option>
<option value="RB Lomas de Barbudal">RB Lomas de Barbudal</option>
<option value="RF Golfo Dulce">RF Golfo Dulce</option>
<option value="RF Taboga">RF Taboga</option>
<option value="RNVS Barra del Colorado">RNVS Barra del Colorado</option>
<option value="RNVS Cano Negro">RNVS Cano Negro</option>
<option value="RNVS Cipanci">RNVS Cipanci</option>
<option value="RNVS Corredor Fronterizo">RNVS Corredor Fronterizo</option>
<option value="RNVS Hacienda El Viejo">RNVS Hacienda El Viejo</option>
<option value="RNVS Maquenque">RNVS Maquenque</option>
<option value="RNVS Mata Redonda">RNVS Mata Redonda</option>
<option value="RNVS Montana de El Tigre">RNVS Montana de El Tigre</option>
<option value="RVS Bahia Junquillal">RVS Bahia Junquillal</option>
<option value="ZP Caraigres">ZP Caraigres</option>
<option value="ZP Guanacaste">ZP Guanacaste</option>
<option value="ZP Las Tablas">ZP Las Tablas</option>
<option value="ZP Miravalles">ZP Miravalles</option>
<option value="ZP Peninsula de Nicoya">ZP Peninsula de Nicoya</option>
<option value="ZP Tivives">ZP Tivives</option></select>
<script type="application/json" data-for="asp" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div></aside>
<button class="collapse-toggle" type="button" title="Toggle sidebar" aria-expanded="true" aria-controls="bslib-sidebar-1">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16" class="bi bi-chevron-left collapse-icon" style="fill:currentColor;" aria-hidden="true" role="img">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path>
    </svg>
</button>
<script data-bslib-sidebar-init="">
bslib.Sidebar.initCollapsibleAll()
</script>
</div>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
# Carga de bibliotecas
library(tidyverse)
library(DT)
library(plotly)
library(sf)
library(tmap)
library(shiny)
library(scales)
library(classInt)

# Especificar modo interactivo para tmap
tmap_mode("view")

# Parámetros generales
CONFIANZA_MINIMA          <- 80
CONFIANZA_MINIMA_ABSOLUTA <- 80
FECHA_MINIMA <- as.Date("2001-01-01")
FECHA_MAXIMA <- as.Date("2024-12-31")
RUTA_DATOS <- "datos/procesados"
</script>
 
<script type="application/shiny-prerendered" data-context="data">
ac        <- readRDS(file.path(RUTA_DATOS, "ac.rds"))
asp       <- readRDS(file.path(RUTA_DATOS, "asp.rds"))
incendios <- readRDS(file.path(RUTA_DATOS, "incendios.rds"))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
# =============================================================================
# FUNCIONES REACTIVAS BASE (existentes)
# =============================================================================

# Función reactiva para filtrar los datos de incendios
# de acuerdo con los filtros especificados por el usuario
filtrar_incendios <- reactive({
  # Se inicia con los datos de incendios sin filtrar
  incendios_filtrados <- incendios

  # Filtrar por confianza mínima
  incendios_filtrados <-
    incendios_filtrados |>
    filter(confidence >= input$confianza_minima)
  
  # Filtrar por rango de fechas
  incendios_filtrados <- 
    incendios_filtrados |>
    filter(
      acq_date >= input$fecha[1],
      acq_date <= input$fecha[2]
    )

  # Filtrar por FRP
  incendios_filtrados <-
    incendios_filtrados |>
    filter(frp >= input$frp[1] & frp <= input$frp[2])

  # Filtrar por AC
  if (input$ac != "Todas") {
    incendios_filtrados <-
      incendios_filtrados |>
      filter(nombre_ac == input$ac)
  }
  
  # Filtrar por ASP
  if (input$asp != "Todas") {
    incendios_filtrados <-
      incendios_filtrados |>
      filter(nombre_asp == input$asp)
  }
  
  return(incendios_filtrados)
})

# Función reactiva para filtrar los datos de áreas de conservación
# con estadísticas de incendios de acuerdo con los filtros especificados por el usuario
filtrar_ac_incendios <- reactive({
  incendios_filtrados <- filtrar_incendios()
  
  # Verificar si hay incendios en AC
  incendios_en_ac <- incendios_filtrados |>
    filter(!is.na(nombre_ac))
  
  if (nrow(incendios_en_ac) > 0) {
    # Si hay incendios en AC, proceder normalmente
    ac_incendios_filtradas <- 
      ac |>
      left_join(
        st_drop_geometry(incendios_filtrados) |>
          count(nombre_ac, name = "incendios_n"),
        by = "nombre_ac"
      ) |>
      mutate(incendios_n = coalesce(incendios_n, 0L)) |>
      filter(incendios_n > 0) |>
      arrange(incendios_n)
  } else {
    # Si no hay incendios, devolver data frame vacío con estructura correcta
    ac_incendios_filtradas <-
      ac |>
      slice(0) |>
      mutate(incendios_n = integer())
  }
  
  return(ac_incendios_filtradas)
})

# Función reactiva para filtrar los datos de ASP
# con estadísticas de incendios de acuerdo con los filtros especificados por el usuario
filtrar_asp_incendios <- reactive({
  incendios_filtrados <- filtrar_incendios()
  
  # Verificar si hay incendios en ASP
  incendios_en_asp <- incendios_filtrados |>
    filter(!is.na(nombre_asp))
  
  if (nrow(incendios_en_asp) > 0) {
    # Si hay incendios en ASP, proceder normalmente
    asp_incendios_filtradas <- 
      asp |>
      left_join(
        st_drop_geometry(incendios_filtrados) |>
          count(nombre_asp, name = "incendios_n"),
        by = "nombre_asp"
      ) |>
      mutate(incendios_n = coalesce(incendios_n, 0L)) |>
      filter(incendios_n > 0) |>
      arrange(incendios_n)
  } else {
    # Si no hay incendios, devolver data frame vacío
    asp_incendios_filtradas <-
      asp |>
      slice(0) |>
      mutate(incendios_n = integer())
  }
  
  return(asp_incendios_filtradas)
})

# =============================================================================
# NUEVA FUNCIÓN REACTIVA: Datos anuales para análisis climático
# =============================================================================

filtrar_datos_anuales <- reactive({
  incendios_filtrados <- filtrar_incendios()
  
  # Agregar datos por año
  datos_anuales <- incendios_filtrados |>
    st_drop_geometry() |>
    mutate(anio = year(acq_date)) |>
    group_by(anio) |>
    summarise(
      n_incendios = n(),
      temp_promedio = mean(TEMPERATURE_2M_ACQ_DATE_MEAN, na.rm = TRUE),
      temp_max = max(TEMPERATURE_2M_ACQ_DATE_MEAN, na.rm = TRUE),
      precip_promedio = mean(PRECIPITATION_ACQ_DATE_SUM, na.rm = TRUE),
      precip_total = sum(PRECIPITATION_ACQ_DATE_SUM, na.rm = TRUE),
      frp_promedio = mean(frp, na.rm = TRUE),
      vel_viento_promedio = mean(X10M_WIND_SPEED_ACQ_DATE_MEAN, na.rm = TRUE),
      .groups = "drop"
    ) |>
    mutate(
      # Calcular anomalías respecto al promedio histórico
      temp_anomalia = temp_promedio - mean(temp_promedio, na.rm = TRUE),
      precip_anomalia = precip_promedio - mean(precip_promedio, na.rm = TRUE),
      # Definir período (para comparaciones)
      periodo = if_else(anio <= 2012, "2001-2012", "2013-2024")
    )
  
  return(datos_anuales)
})

# Función reactiva para calcular métricas climáticas
calcular_metricas <- reactive({
  datos <- filtrar_datos_anuales()
  
  # Verificar que hay suficientes datos
  if (nrow(datos) < 3) {
    return(list(
      tendencia_temp = NA,
      tendencia_incendios = NA,
      correlacion = NA,
      p_valor = NA,
      cambio_pct = NA,
      significativo = FALSE
    ))
  }
  
  # Modelos de tendencia
  modelo_temp <- lm(temp_promedio ~ anio, data = datos)
  modelo_incendios <- lm(n_incendios ~ anio, data = datos)
  
  # Correlación
  cor_test <- cor.test(datos$temp_promedio, datos$n_incendios)
  
  # Cambio entre períodos
  periodo1 <- datos |> filter(periodo == "2001-2012")
  periodo2 <- datos |> filter(periodo == "2013-2024")
  
  prom1 <- if(nrow(periodo1) > 0) mean(periodo1$n_incendios, na.rm = TRUE) else NA
  prom2 <- if(nrow(periodo2) > 0) mean(periodo2$n_incendios, na.rm = TRUE) else NA
  cambio_pct <- if(!is.na(prom1) && !is.na(prom2) && prom1 > 0) {
    ((prom2 - prom1) / prom1) * 100
  } else {
    NA
  }
  
  list(
    tendencia_temp = coef(modelo_temp)[2] * 10,  # °C por década
    tendencia_incendios = coef(modelo_incendios)[2] * 10,  # incendios por década
    correlacion = cor_test$estimate,
    p_valor = cor_test$p.value,
    cambio_pct = cambio_pct,
    significativo = cor_test$p.value < 0.05
  )
})

# Título dinámico según filtros
titulo_area <- reactive({
  if (input$asp != "Todas") {
    input$asp
  } else if (input$ac != "Todas") {
    input$ac
  } else {
    "Costa Rica"
  }
})

# =============================================================================
# TARJETAS DE MÉTRICAS PARA ANÁLISIS CLIMÁTICO
# =============================================================================

# Función auxiliar para crear tarjeta HTML
crear_tarjeta <- function(valor, color = "#dc3545", icono = "🌡️") {
  sprintf(
    '<div style="text-align: center; padding: 10px;">
      <span style="font-size: 2em;">%s<\u002fspan>
      <div style="font-size: 1.8em; font-weight: bold; color: %s; margin-top: 5px;">%s<\u002fdiv>
    <\u002fdiv>',
    icono, color, valor
  )
}

output$card_tendencia_temp <- renderUI({
  metricas <- calcular_metricas()
  
  valor <- if(is.na(metricas$tendencia_temp)) {
    "Sin datos"
  } else {
    sprintf("%+.2f °C/déc", metricas$tendencia_temp)
  }
  
  color <- if(is.na(metricas$tendencia_temp) || metricas$tendencia_temp <= 0) "#6c757d" else "#dc3545"
  
  HTML(crear_tarjeta(valor, color, "🌡️"))
})

output$card_tendencia_incendios <- renderUI({
  metricas <- calcular_metricas()
  
  valor <- if(is.na(metricas$tendencia_incendios)) {
    "Sin datos"
  } else {
    sprintf("%+.0f /déc", metricas$tendencia_incendios)
  }
  
  color <- if(is.na(metricas$tendencia_incendios) || metricas$tendencia_incendios <= 0) "#28a745" else "#dc3545"
  
  HTML(crear_tarjeta(valor, color, "🔥"))
})

output$card_correlacion <- renderUI({
  metricas <- calcular_metricas()
  
  valor <- if(is.na(metricas$correlacion)) {
    "Sin datos"
  } else {
    signif_text <- if(metricas$significativo) " *" else ""
    sprintf("r = %.2f%s", metricas$correlacion, signif_text)
  }
  
  color <- if(is.na(metricas$correlacion)) "#6c757d" else if(abs(metricas$correlacion) > 0.5) "#ffc107" else "#6c757d"
  
  HTML(crear_tarjeta(valor, color, "📈"))
})

output$card_cambio_periodo <- renderUI({
  metricas <- calcular_metricas()
  
  valor <- if(is.na(metricas$cambio_pct)) {
    "Sin datos"
  } else {
    sprintf("%+.1f%%", metricas$cambio_pct)
  }
  
  color <- if(is.na(metricas$cambio_pct)) {
    "#6c757d"
  } else if(metricas$cambio_pct > 10) {
    "#dc3545"
  } else if(metricas$cambio_pct < -10) {
    "#28a745"
  } else {
    "#ffc107"
  }
  
  HTML(crear_tarjeta(valor, color, "↔️"))
})

# =============================================================================
# GRÁFICOS PARA ANÁLISIS CLIMÁTICO
# =============================================================================

# Gráfico de tendencias duales (temperatura + incendios)
output$grafico_tendencias_duales <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  # Verificar datos suficientes
  if (nrow(datos) < 2) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes para mostrar tendencias",
          annotations = list(
            list(
              text = "Seleccione un rango de fechas más amplio",
              x = 0.5, y = 0.5,
              xref = "paper", yref = "paper",
              showarrow = FALSE, font = list(size = 14)
            )
          )
        )
    )
  }
  
  # Calcular tendencias lineales
  modelo_temp <- lm(temp_promedio ~ anio, data = datos)
  modelo_incendios <- lm(n_incendios ~ anio, data = datos)
  
  # Coeficientes para mostrar
  tendencia_temp <- coef(modelo_temp)[2] * 10  # cambio por década
  tendencia_incendios <- coef(modelo_incendios)[2] * 10
  
  # Predicciones para líneas de tendencia
  datos$pred_temp <- predict(modelo_temp)
  datos$pred_inc <- predict(modelo_incendios)
  
  # Gráfico con plotly
 fig <- plot_ly(datos) |>
    # Línea de temperatura
    add_trace(
      x = ~anio, 
      y = ~temp_promedio,
      type = "scatter", 
      mode = "lines+markers",
      name = "Temperatura (°C)",
      line = list(color = "#e74c3c", width = 2),
      marker = list(size = 8, color = "#e74c3c"),
      yaxis = "y1",
      hovertemplate = paste0(
        "<b>%{x}<\u002fb><br>",
        "Temperatura: %{y:.1f}°C",
        "<extra><\u002fextra>"
      )
    ) |>
    # Línea de tendencia temperatura
    add_trace(
      x = ~anio,
      y = ~pred_temp,
      type = "scatter",
      mode = "lines",
      name = sprintf("Tendencia temp (%+.2f°C/década)", tendencia_temp),
      line = list(color = "#e74c3c", width = 1.5, dash = "dash"),
      yaxis = "y1",
      hoverinfo = "skip"
    ) |>
    # Línea de incendios
    add_trace(
      x = ~anio, 
      y = ~n_incendios,
      type = "scatter", 
      mode = "lines+markers",
      name = "Cantidad de incendios",
      line = list(color = "#3498db", width = 2),
      marker = list(size = 8, color = "#3498db"),
      yaxis = "y2",
      hovertemplate = paste0(
        "<b>%{x}<\u002fb><br>",
        "Incendios: %{y:,.0f}",
        "<extra><\u002fextra>"
      )
    ) |>
    # Línea de tendencia incendios
    add_trace(
      x = ~anio,
      y = ~pred_inc,
      type = "scatter",
      mode = "lines",
      name = sprintf("Tendencia incendios (%+.0f/década)", tendencia_incendios),
      line = list(color = "#3498db", width = 1.5, dash = "dash"),
      yaxis = "y2",
      hoverinfo = "skip"
    ) |>
    layout(
      title = list(
        text = paste("Tendencias de temperatura e incendios -", titulo),
        font = list(size = 14)
      ),
      xaxis = list(title = "Año", dtick = 2),
      yaxis = list(
        title = "Temperatura promedio (°C)",
        titlefont = list(color = "#e74c3c"),
        tickfont = list(color = "#e74c3c"),
        side = "left"
      ),
      yaxis2 = list(
        title = "Cantidad de incendios",
        titlefont = list(color = "#3498db"),
        tickfont = list(color = "#3498db"),
        overlaying = "y",
        side = "right",
        tickformat = ",.0f"
      ),
      legend = list(
        orientation = "h",
        y = -0.2,
        x = 0.5,
        xanchor = "center"
      ),
      hovermode = "x unified",
      margin = list(t = 50, r = 80, b = 80, l = 80)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de correlación (scatter plot)
output$grafico_correlacion <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  # Verificar datos suficientes
  if (nrow(datos) < 3) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes para análisis de correlación",
          annotations = list(
            list(
              text = "Se requieren al menos 3 años de datos",
              x = 0.5, y = 0.5,
              xref = "paper", yref = "paper",
              showarrow = FALSE, font = list(size = 14)
            )
          )
        )
    )
  }
  
  # Calcular correlación
  cor_test <- cor.test(datos$temp_promedio, datos$n_incendios)
  r <- cor_test$estimate
  p_valor <- cor_test$p.value
  
  # Modelo lineal
  modelo <- lm(n_incendios ~ temp_promedio, data = datos)
  datos$pred <- predict(modelo)
  
  # Texto de significancia
  signif_text <- if(p_valor < 0.001) {
    "***"
  } else if(p_valor < 0.01) {
    "**"
  } else if(p_valor < 0.05) {
    "*"
  } else {
    ""
  }
  
  # Escala de color por año
  fig <- plot_ly(datos) |>
    add_trace(
      x = ~temp_promedio,
      y = ~n_incendios,
      type = "scatter",
      mode = "markers",
      marker = list(
        size = 14,
        color = ~anio,
        colorscale = "Viridis",
        showscale = TRUE,
        colorbar = list(title = "Año", tickformat = "d")
      ),
      text = ~anio,
      hovertemplate = paste0(
        "<b>Año: %{text}<\u002fb><br>",
        "Temperatura: %{x:.1f}°C<br>",
        "Incendios: %{y:,.0f}",
        "<extra><\u002fextra>"
      )
    ) |>
    # Línea de regresión
    add_trace(
      x = ~temp_promedio,
      y = ~pred,
      type = "scatter",
      mode = "lines",
      name = "Regresión lineal",
      line = list(color = "red", width = 2),
      hoverinfo = "skip"
    ) |>
    layout(
      title = list(
        text = paste0(
          titulo, "<br>",
          "<sup>r = ", sprintf("%.3f", r), signif_text,
          " (p = ", sprintf("%.4f", p_valor), ")<\u002fsup>"
        ),
        font = list(size = 14)
      ),
      xaxis = list(title = "Temperatura promedio (°C)"),
      yaxis = list(title = "Cantidad de incendios", tickformat = ",.0f"),
      showlegend = FALSE,
      annotations = list(
        list(
          x = 1, y = 0,
          text = "* p<0.05, ** p<0.01, *** p<0.001",
          showarrow = FALSE,
          xref = "paper", yref = "paper",
          xanchor = "right", yanchor = "bottom",
          font = list(size = 10, color = "gray")
        )
      ),
      margin = list(t = 70, r = 50, b = 60, l = 70)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de comparación de períodos
output$grafico_comparacion_periodos <- renderPlotly({
  datos <- filtrar_datos_anuales()
  
  # Verificar datos en ambos períodos
  periodo1 <- datos |> filter(periodo == "2001-2012")
  periodo2 <- datos |> filter(periodo == "2013-2024")
  
  if (nrow(periodo1) == 0 || nrow(periodo2) == 0) {
    return(
      plot_ly() |>
        layout(
          title = "Se requieren datos en ambos períodos",
          annotations = list(
            list(
              text = "Ajuste el rango de fechas para incluir ambos períodos",
              x = 0.5, y = 0.5,
              xref = "paper", yref = "paper",
              showarrow = FALSE, font = list(size = 14)
            )
          )
        )
    )
  }
  
  # Agregar por período para múltiples variables
  resumen <- datos |>
    group_by(periodo) |>
    summarise(
      incendios_prom = mean(n_incendios, na.rm = TRUE),
      incendios_sd = sd(n_incendios, na.rm = TRUE),
      temp_prom = mean(temp_promedio, na.rm = TRUE),
      temp_sd = sd(temp_promedio, na.rm = TRUE),
      n = n(),
      .groups = "drop"
    ) |>
    mutate(
      incendios_error = qt(0.975, n - 1) * incendios_sd / sqrt(n),
      temp_error = qt(0.975, n - 1) * temp_sd / sqrt(n)
    )
  
  # Calcular cambios porcentuales
  cambio_inc <- ((resumen$incendios_prom[2] - resumen$incendios_prom[1]) / 
                   resumen$incendios_prom[1]) * 100
  cambio_temp <- resumen$temp_prom[2] - resumen$temp_prom[1]
  
  # Crear subplots
  fig <- subplot(
    # Subplot 1: Incendios
    plot_ly(resumen) |>
      add_trace(
        x = ~periodo,
        y = ~incendios_prom,
        type = "bar",
        name = "Incendios",
        marker = list(color = c("#3498db", "#e74c3c")),
        error_y = list(type = "data", array = ~incendios_error, color = "black"),
        hovertemplate = paste0(
          "<b>%{x}<\u002fb><br>",
          "Promedio: %{y:.0f} incendios/año",
          "<extra><\u002fextra>"
        )
      ) |>
      layout(
        yaxis = list(title = "Incendios promedio/año"),
        annotations = list(
          list(
            x = 0.5, y = 1.05,
            text = sprintf("Cambio: %+.1f%%", cambio_inc),
            showarrow = FALSE,
            xref = "paper", yref = "paper",
            font = list(size = 12, color = if(cambio_inc > 0) "red" else "green")
          )
        )
      ),
    # Subplot 2: Temperatura
    plot_ly(resumen) |>
      add_trace(
        x = ~periodo,
        y = ~temp_prom,
        type = "bar",
        name = "Temperatura",
        marker = list(color = c("#f39c12", "#e74c3c")),
        error_y = list(type = "data", array = ~temp_error, color = "black"),
        hovertemplate = paste0(
          "<b>%{x}<\u002fb><br>",
          "Temperatura: %{y:.1f}°C",
          "<extra><\u002fextra>"
        )
      ) |>
      layout(
        yaxis = list(title = "Temperatura promedio (°C)"),
        annotations = list(
          list(
            x = 0.5, y = 1.05,
            text = sprintf("Cambio: %+.2f°C", cambio_temp),
            showarrow = FALSE,
            xref = "paper", yref = "paper",
            font = list(size = 12, color = if(cambio_temp > 0) "red" else "blue")
          )
        )
      ),
    nrows = 1,
    shareX = TRUE,
    titleX = FALSE
  ) |>
    layout(
      title = list(
        text = "Comparación entre períodos",
        font = list(size = 14)
      ),
      showlegend = FALSE,
      margin = list(t = 70, b = 50)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de anomalías de temperatura
output$grafico_anomalias <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  if (nrow(datos) < 2) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes",
          annotations = list(
            list(
              text = "Seleccione un rango de fechas más amplio",
              x = 0.5, y = 0.5,
              xref = "paper", yref = "paper",
              showarrow = FALSE, font = list(size = 14)
            )
          )
        )
    )
  }
  
  # Escalar incendios para visualización en el mismo eje
  rango_anomalia <- range(datos$temp_anomalia, na.rm = TRUE)
  datos <- datos |>
    mutate(
      incendios_escalados = scales::rescale(
        n_incendios, 
        to = c(rango_anomalia[1] * 0.8, rango_anomalia[2] * 0.8)
      )
    )
  
  fig <- plot_ly(datos) |>
    # Barras de anomalía de temperatura
    add_trace(
      x = ~anio,
      y = ~temp_anomalia,
      type = "bar",
      name = "Anomalía de temperatura",
      marker = list(
        color = ~ifelse(temp_anomalia > 0, "#e74c3c", "#3498db")
      ),
      hovertemplate = paste0(
        "<b>%{x}<\u002fb><br>",
        "Anomalía: %{y:+.2f}°C",
        "<extra><\u002fextra>"
      )
    ) |>
    # Puntos de incendios
    add_trace(
      x = ~anio,
      y = ~incendios_escalados,
      type = "scatter",
      mode = "markers",
      name = "Incendios (escalados)",
      marker = list(
        size = ~scales::rescale(n_incendios, to = c(8, 20)),
        color = "black",
        symbol = "diamond",
        line = list(color = "white", width = 1)
      ),
      customdata = ~n_incendios,
      hovertemplate = paste0(
        "<b>%{x}<\u002fb><br>",
        "Incendios: %{customdata:,.0f}",
        "<extra><\u002fextra>"
      )
    ) |>
    layout(
      title = list(
        text = paste("Anomalías de temperatura -", titulo),
        font = list(size = 14)
      ),
      xaxis = list(title = "Año", dtick = 2),
      yaxis = list(
        title = "Anomalía de temperatura (°C)",
        zeroline = TRUE,
        zerolinecolor = "black",
        zerolinewidth = 1.5
      ),
      legend = list(orientation = "h", y = -0.15, x = 0.5, xanchor = "center"),
      barmode = "relative",
      margin = list(t = 50, b = 70)
    ) |>
    config(locale = "es")
  
  fig
})

# =============================================================================
# TARJETAS Y GRÁFICOS PARA ANÁLISIS DE PRECIPITACIÓN
# =============================================================================

# Función reactiva para calcular métricas de precipitación
calcular_metricas_precip <- reactive({
  datos <- filtrar_datos_anuales()
  
  # Verificar que hay suficientes datos
  if (nrow(datos) < 3) {
    return(list(
      tendencia_precip = NA,
      tendencia_incendios = NA,
      correlacion = NA,
      p_valor = NA,
      cambio_pct = NA,
      significativo = FALSE
    ))
  }
  
  # Modelos de tendencia
  modelo_precip <- lm(precip_promedio ~ anio, data = datos)
  modelo_incendios <- lm(n_incendios ~ anio, data = datos)
  
  # Correlación
  cor_test <- cor.test(datos$precip_promedio, datos$n_incendios)
  
  # Cambio entre períodos
  periodo1 <- datos |> filter(periodo == "2001-2012")
  periodo2 <- datos |> filter(periodo == "2013-2024")
  
  prom1 <- if(nrow(periodo1) > 0) mean(periodo1$n_incendios, na.rm = TRUE) else NA
  prom2 <- if(nrow(periodo2) > 0) mean(periodo2$n_incendios, na.rm = TRUE) else NA
  cambio_pct <- if(!is.na(prom1) && !is.na(prom2) && prom1 > 0) {
    ((prom2 - prom1) / prom1) * 100
  } else {
    NA
  }
  
  list(
    tendencia_precip = coef(modelo_precip)[2] * 10,  # mm por década
    tendencia_incendios = coef(modelo_incendios)[2] * 10,
    correlacion = cor_test$estimate,
    p_valor = cor_test$p.value,
    cambio_pct = cambio_pct,
    significativo = cor_test$p.value < 0.05
  )
})

# Tarjetas de métricas para precipitación
output$card_tendencia_precip <- renderUI({
  metricas <- calcular_metricas_precip()
  
  valor <- if(is.na(metricas$tendencia_precip)) {
    "Sin datos"
  } else {
    sprintf("%+.2f mm/déc", metricas$tendencia_precip)
  }
  
  # Menos precipitación = preocupante (rojo), más = favorable (azul)
  color <- if(is.na(metricas$tendencia_precip)) {
    "#6c757d"
  } else if(metricas$tendencia_precip < 0) {
    "#dc3545"  # Rojo - menos lluvia es preocupante
  } else {
    "#17a2b8"  # Azul - más lluvia
  }
  
  HTML(crear_tarjeta(valor, color, "🌧️"))
})

output$card_tendencia_incendios_precip <- renderUI({
  metricas <- calcular_metricas_precip()
  
  valor <- if(is.na(metricas$tendencia_incendios)) {
    "Sin datos"
  } else {
    sprintf("%+.0f /déc", metricas$tendencia_incendios)
  }
  
  color <- if(is.na(metricas$tendencia_incendios) || metricas$tendencia_incendios <= 0) "#28a745" else "#dc3545"
  
  HTML(crear_tarjeta(valor, color, "🔥"))
})

output$card_correlacion_precip <- renderUI({
  metricas <- calcular_metricas_precip()
  
  valor <- if(is.na(metricas$correlacion)) {
    "Sin datos"
  } else {
    signif_text <- if(metricas$significativo) " *" else ""
    sprintf("r = %.2f%s", metricas$correlacion, signif_text)
  }
  
  color <- if(is.na(metricas$correlacion)) "#6c757d" else if(abs(metricas$correlacion) > 0.5) "#ffc107" else "#6c757d"
  
  HTML(crear_tarjeta(valor, color, "📈"))
})

output$card_cambio_periodo_precip <- renderUI({
  metricas <- calcular_metricas_precip()
  
  valor <- if(is.na(metricas$cambio_pct)) {
    "Sin datos"
  } else {
    sprintf("%+.1f%%", metricas$cambio_pct)
  }
  
  color <- if(is.na(metricas$cambio_pct)) {
    "#6c757d"
  } else if(metricas$cambio_pct > 10) {
    "#dc3545"
  } else if(metricas$cambio_pct < -10) {
    "#28a745"
  } else {
    "#ffc107"
  }
  
  HTML(crear_tarjeta(valor, color, "↔️"))
})

# Gráfico de tendencias duales (precipitación + incendios)
output$grafico_tendencias_precip <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  if (nrow(datos) < 2) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes para mostrar tendencias",
          annotations = list(list(
            text = "Seleccione un rango de fechas más amplio",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  # Calcular tendencias lineales
  modelo_precip <- lm(precip_promedio ~ anio, data = datos)
  modelo_incendios <- lm(n_incendios ~ anio, data = datos)
  
  tendencia_precip <- coef(modelo_precip)[2] * 10
  tendencia_incendios <- coef(modelo_incendios)[2] * 10
  
  datos$pred_precip <- predict(modelo_precip)
  datos$pred_inc <- predict(modelo_incendios)
  
  fig <- plot_ly(datos) |>
    add_trace(
      x = ~anio, y = ~precip_promedio,
      type = "scatter", mode = "lines+markers",
      name = "Precipitación (mm)",
      line = list(color = "#17a2b8", width = 2),
      marker = list(size = 8, color = "#17a2b8"),
      yaxis = "y1",
      hovertemplate = "<b>%{x}<\u002fb><br>Precipitación: %{y:.2f} mm<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~anio, y = ~pred_precip,
      type = "scatter", mode = "lines",
      name = sprintf("Tendencia precip (%+.2f mm/década)", tendencia_precip),
      line = list(color = "#17a2b8", width = 1.5, dash = "dash"),
      yaxis = "y1", hoverinfo = "skip"
    ) |>
    add_trace(
      x = ~anio, y = ~n_incendios,
      type = "scatter", mode = "lines+markers",
      name = "Cantidad de incendios",
      line = list(color = "#fd7e14", width = 2),
      marker = list(size = 8, color = "#fd7e14"),
      yaxis = "y2",
      hovertemplate = "<b>%{x}<\u002fb><br>Incendios: %{y:,.0f}<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~anio, y = ~pred_inc,
      type = "scatter", mode = "lines",
      name = sprintf("Tendencia incendios (%+.0f/década)", tendencia_incendios),
      line = list(color = "#fd7e14", width = 1.5, dash = "dash"),
      yaxis = "y2", hoverinfo = "skip"
    ) |>
    layout(
      title = list(
        text = paste("Tendencias de precipitación e incendios -", titulo),
        font = list(size = 14)
      ),
      xaxis = list(title = "Año", dtick = 2),
      yaxis = list(
        title = "Precipitación promedio (mm)",
        titlefont = list(color = "#17a2b8"),
        tickfont = list(color = "#17a2b8"),
        side = "left"
      ),
      yaxis2 = list(
        title = "Cantidad de incendios",
        titlefont = list(color = "#fd7e14"),
        tickfont = list(color = "#fd7e14"),
        overlaying = "y",
        side = "right",
        tickformat = ",.0f"
      ),
      legend = list(orientation = "h", y = -0.2, x = 0.5, xanchor = "center"),
      hovermode = "x unified",
      margin = list(t = 50, r = 80, b = 80, l = 80)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de correlación precipitación-incendios
output$grafico_correlacion_precip <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  if (nrow(datos) < 3) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes para análisis de correlación",
          annotations = list(list(
            text = "Se requieren al menos 3 años de datos",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  cor_test <- cor.test(datos$precip_promedio, datos$n_incendios)
  r <- cor_test$estimate
  p_valor <- cor_test$p.value
  
  modelo <- lm(n_incendios ~ precip_promedio, data = datos)
  datos$pred <- predict(modelo)
  
  signif_text <- if(p_valor < 0.001) "***" else if(p_valor < 0.01) "**" else if(p_valor < 0.05) "*" else ""
  
  fig <- plot_ly(datos) |>
    add_trace(
      x = ~precip_promedio, y = ~n_incendios,
      type = "scatter", mode = "markers",
      marker = list(
        size = 14, color = ~anio,
        colorscale = "Viridis", showscale = TRUE,
        colorbar = list(title = "Año", tickformat = "d")
      ),
      text = ~anio,
      hovertemplate = "<b>Año: %{text}<\u002fb><br>Precipitación: %{x:.2f} mm<br>Incendios: %{y:,.0f}<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~precip_promedio, y = ~pred,
      type = "scatter", mode = "lines",
      name = "Regresión lineal",
      line = list(color = "#17a2b8", width = 2),
      hoverinfo = "skip"
    ) |>
    layout(
      title = list(
        text = paste0(titulo, "<br><sup>r = ", sprintf("%.3f", r), signif_text, " (p = ", sprintf("%.4f", p_valor), ")<\u002fsup>"),
        font = list(size = 14)
      ),
      xaxis = list(title = "Precipitación promedio (mm)"),
      yaxis = list(title = "Cantidad de incendios", tickformat = ",.0f"),
      showlegend = FALSE,
      annotations = list(list(
        x = 1, y = 0,
        text = "* p<0.05, ** p<0.01, *** p<0.001",
        showarrow = FALSE, xref = "paper", yref = "paper",
        xanchor = "right", yanchor = "bottom",
        font = list(size = 10, color = "gray")
      )),
      margin = list(t = 70, r = 50, b = 60, l = 70)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de comparación de períodos para precipitación
output$grafico_comparacion_periodos_precip <- renderPlotly({
  datos <- filtrar_datos_anuales()
  
  periodo1 <- datos |> filter(periodo == "2001-2012")
  periodo2 <- datos |> filter(periodo == "2013-2024")
  
  if (nrow(periodo1) == 0 || nrow(periodo2) == 0) {
    return(
      plot_ly() |>
        layout(
          title = "Se requieren datos en ambos períodos",
          annotations = list(list(
            text = "Ajuste el rango de fechas para incluir ambos períodos",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  resumen <- datos |>
    group_by(periodo) |>
    summarise(
      incendios_prom = mean(n_incendios, na.rm = TRUE),
      incendios_sd = sd(n_incendios, na.rm = TRUE),
      precip_prom = mean(precip_promedio, na.rm = TRUE),
      precip_sd = sd(precip_promedio, na.rm = TRUE),
      n = n(),
      .groups = "drop"
    ) |>
    mutate(
      incendios_error = qt(0.975, n - 1) * incendios_sd / sqrt(n),
      precip_error = qt(0.975, n - 1) * precip_sd / sqrt(n)
    )
  
  cambio_inc <- ((resumen$incendios_prom[2] - resumen$incendios_prom[1]) / resumen$incendios_prom[1]) * 100
  cambio_precip <- ((resumen$precip_prom[2] - resumen$precip_prom[1]) / resumen$precip_prom[1]) * 100
  
  fig <- subplot(
    plot_ly(resumen) |>
      add_trace(
        x = ~periodo, y = ~incendios_prom,
        type = "bar", name = "Incendios",
        marker = list(color = c("#3498db", "#e74c3c")),
        error_y = list(type = "data", array = ~incendios_error, color = "black"),
        hovertemplate = "<b>%{x}<\u002fb><br>Promedio: %{y:.0f} incendios/año<extra><\u002fextra>"
      ) |>
      layout(
        yaxis = list(title = "Incendios promedio/año"),
        annotations = list(list(
          x = 0.5, y = 1.05,
          text = sprintf("Cambio: %+.1f%%", cambio_inc),
          showarrow = FALSE, xref = "paper", yref = "paper",
          font = list(size = 12, color = if(cambio_inc > 0) "red" else "green")
        ))
      ),
    plot_ly(resumen) |>
      add_trace(
        x = ~periodo, y = ~precip_prom,
        type = "bar", name = "Precipitación",
        marker = list(color = c("#17a2b8", "#0d6efd")),
        error_y = list(type = "data", array = ~precip_error, color = "black"),
        hovertemplate = "<b>%{x}<\u002fb><br>Precipitación: %{y:.2f} mm<extra><\u002fextra>"
      ) |>
      layout(
        yaxis = list(title = "Precipitación promedio (mm)"),
        annotations = list(list(
          x = 0.5, y = 1.05,
          text = sprintf("Cambio: %+.1f%%", cambio_precip),
          showarrow = FALSE, xref = "paper", yref = "paper",
          font = list(size = 12, color = if(cambio_precip < 0) "red" else "blue")
        ))
      ),
    nrows = 1, shareX = TRUE, titleX = FALSE
  ) |>
    layout(
      title = list(text = "Comparación entre períodos", font = list(size = 14)),
      showlegend = FALSE,
      margin = list(t = 70, b = 50)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de anomalías de precipitación
output$grafico_anomalias_precip <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  if (nrow(datos) < 2) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes",
          annotations = list(list(
            text = "Seleccione un rango de fechas más amplio",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  rango_anomalia <- range(datos$precip_anomalia, na.rm = TRUE)
  datos <- datos |>
    mutate(
      incendios_escalados = scales::rescale(
        n_incendios, 
        to = c(rango_anomalia[1] * 0.8, rango_anomalia[2] * 0.8)
      )
    )
  
  fig <- plot_ly(datos) |>
    add_trace(
      x = ~anio, y = ~precip_anomalia,
      type = "bar",
      name = "Anomalía de precipitación",
      marker = list(
        # Más lluvia = azul (positivo), menos lluvia = rojo (negativo/preocupante)
        color = ~ifelse(precip_anomalia > 0, "#17a2b8", "#dc3545")
      ),
      hovertemplate = "<b>%{x}<\u002fb><br>Anomalía: %{y:+.2f} mm<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~anio, y = ~incendios_escalados,
      type = "scatter", mode = "markers",
      name = "Incendios (escalados)",
      marker = list(
        size = ~scales::rescale(n_incendios, to = c(8, 20)),
        color = "black", symbol = "diamond",
        line = list(color = "white", width = 1)
      ),
      customdata = ~n_incendios,
      hovertemplate = "<b>%{x}<\u002fb><br>Incendios: %{customdata:,.0f}<extra><\u002fextra>"
    ) |>
    layout(
      title = list(
        text = paste("Anomalías de precipitación -", titulo),
        font = list(size = 14)
      ),
      xaxis = list(title = "Año", dtick = 2),
      yaxis = list(
        title = "Anomalía de precipitación (mm)",
        zeroline = TRUE,
        zerolinecolor = "black",
        zerolinewidth = 1.5
      ),
      legend = list(orientation = "h", y = -0.15, x = 0.5, xanchor = "center"),
      barmode = "relative",
      margin = list(t = 50, b = 70)
    ) |>
    config(locale = "es")
  
  fig
})

# =============================================================================
# TARJETAS Y GRÁFICOS PARA ANÁLISIS DE VELOCIDAD DEL VIENTO
# =============================================================================

# Función reactiva para calcular métricas de viento
calcular_metricas_viento <- reactive({
  datos <- filtrar_datos_anuales()
  
  if (nrow(datos) < 3) {
    return(list(
      tendencia_viento = NA,
      tendencia_incendios = NA,
      correlacion = NA,
      p_valor = NA,
      cambio_pct = NA,
      significativo = FALSE
    ))
  }
  
  # Modelos de tendencia
  modelo_viento <- lm(vel_viento_promedio ~ anio, data = datos)
  modelo_incendios <- lm(n_incendios ~ anio, data = datos)
  
  # Correlación
  cor_test <- cor.test(datos$vel_viento_promedio, datos$n_incendios)
  
  # Cambio entre períodos
  periodo1 <- datos |> filter(periodo == "2001-2012")
  periodo2 <- datos |> filter(periodo == "2013-2024")
  
  prom1 <- if(nrow(periodo1) > 0) mean(periodo1$n_incendios, na.rm = TRUE) else NA
  prom2 <- if(nrow(periodo2) > 0) mean(periodo2$n_incendios, na.rm = TRUE) else NA
  cambio_pct <- if(!is.na(prom1) && !is.na(prom2) && prom1 > 0) {
    ((prom2 - prom1) / prom1) * 100
  } else {
    NA
  }
  
  list(
    tendencia_viento = coef(modelo_viento)[2] * 10,  # m/s por década
    tendencia_incendios = coef(modelo_incendios)[2] * 10,
    correlacion = cor_test$estimate,
    p_valor = cor_test$p.value,
    cambio_pct = cambio_pct,
    significativo = cor_test$p.value < 0.05
  )
})

# Tarjetas de métricas para viento
output$card_tendencia_viento <- renderUI({
  metricas <- calcular_metricas_viento()
  
  valor <- if(is.na(metricas$tendencia_viento)) {
    "Sin datos"
  } else {
    sprintf("%+.2f m/s/déc", metricas$tendencia_viento)
  }
  
  # Más viento = preocupante (puede propagar incendios)
  color <- if(is.na(metricas$tendencia_viento)) {
    "#6c757d"
  } else if(metricas$tendencia_viento > 0) {
    "#fd7e14"  # Naranja - más viento puede ser preocupante
  } else {
    "#28a745"  # Verde - menos viento
  }
  
  HTML(crear_tarjeta(valor, color, "💨"))
})

output$card_tendencia_incendios_viento <- renderUI({
  metricas <- calcular_metricas_viento()
  
  valor <- if(is.na(metricas$tendencia_incendios)) {
    "Sin datos"
  } else {
    sprintf("%+.0f /déc", metricas$tendencia_incendios)
  }
  
  color <- if(is.na(metricas$tendencia_incendios) || metricas$tendencia_incendios <= 0) "#28a745" else "#dc3545"
  
  HTML(crear_tarjeta(valor, color, "🔥"))
})

output$card_correlacion_viento <- renderUI({
  metricas <- calcular_metricas_viento()
  
  valor <- if(is.na(metricas$correlacion)) {
    "Sin datos"
  } else {
    signif_text <- if(metricas$significativo) " *" else ""
    sprintf("r = %.2f%s", metricas$correlacion, signif_text)
  }
  
  color <- if(is.na(metricas$correlacion)) "#6c757d" else if(abs(metricas$correlacion) > 0.5) "#ffc107" else "#6c757d"
  
  HTML(crear_tarjeta(valor, color, "📈"))
})

output$card_cambio_periodo_viento <- renderUI({
  metricas <- calcular_metricas_viento()
  
  valor <- if(is.na(metricas$cambio_pct)) {
    "Sin datos"
  } else {
    sprintf("%+.1f%%", metricas$cambio_pct)
  }
  
  color <- if(is.na(metricas$cambio_pct)) {
    "#6c757d"
  } else if(metricas$cambio_pct > 10) {
    "#dc3545"
  } else if(metricas$cambio_pct < -10) {
    "#28a745"
  } else {
    "#ffc107"
  }
  
  HTML(crear_tarjeta(valor, color, "↔️"))
})

# Gráfico de tendencias duales (viento + incendios)
output$grafico_tendencias_viento <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  if (nrow(datos) < 2) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes para mostrar tendencias",
          annotations = list(list(
            text = "Seleccione un rango de fechas más amplio",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  modelo_viento <- lm(vel_viento_promedio ~ anio, data = datos)
  modelo_incendios <- lm(n_incendios ~ anio, data = datos)
  
  tendencia_viento <- coef(modelo_viento)[2] * 10
  tendencia_incendios <- coef(modelo_incendios)[2] * 10
  
  datos$pred_viento <- predict(modelo_viento)
  datos$pred_inc <- predict(modelo_incendios)
  
  fig <- plot_ly(datos) |>
    add_trace(
      x = ~anio, y = ~vel_viento_promedio,
      type = "scatter", mode = "lines+markers",
      name = "Velocidad del viento (m/s)",
      line = list(color = "#6f42c1", width = 2),
      marker = list(size = 8, color = "#6f42c1"),
      yaxis = "y1",
      hovertemplate = "<b>%{x}<\u002fb><br>Viento: %{y:.2f} m/s<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~anio, y = ~pred_viento,
      type = "scatter", mode = "lines",
      name = sprintf("Tendencia viento (%+.2f m/s/década)", tendencia_viento),
      line = list(color = "#6f42c1", width = 1.5, dash = "dash"),
      yaxis = "y1", hoverinfo = "skip"
    ) |>
    add_trace(
      x = ~anio, y = ~n_incendios,
      type = "scatter", mode = "lines+markers",
      name = "Cantidad de incendios",
      line = list(color = "#fd7e14", width = 2),
      marker = list(size = 8, color = "#fd7e14"),
      yaxis = "y2",
      hovertemplate = "<b>%{x}<\u002fb><br>Incendios: %{y:,.0f}<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~anio, y = ~pred_inc,
      type = "scatter", mode = "lines",
      name = sprintf("Tendencia incendios (%+.0f/década)", tendencia_incendios),
      line = list(color = "#fd7e14", width = 1.5, dash = "dash"),
      yaxis = "y2", hoverinfo = "skip"
    ) |>
    layout(
      title = list(
        text = paste("Tendencias de velocidad del viento e incendios -", titulo),
        font = list(size = 14)
      ),
      xaxis = list(title = "Año", dtick = 2),
      yaxis = list(
        title = "Velocidad del viento (m/s)",
        titlefont = list(color = "#6f42c1"),
        tickfont = list(color = "#6f42c1"),
        side = "left"
      ),
      yaxis2 = list(
        title = "Cantidad de incendios",
        titlefont = list(color = "#fd7e14"),
        tickfont = list(color = "#fd7e14"),
        overlaying = "y",
        side = "right",
        tickformat = ",.0f"
      ),
      legend = list(orientation = "h", y = -0.2, x = 0.5, xanchor = "center"),
      hovermode = "x unified",
      margin = list(t = 50, r = 80, b = 80, l = 80)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de correlación viento-incendios
output$grafico_correlacion_viento <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  if (nrow(datos) < 3) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes para análisis de correlación",
          annotations = list(list(
            text = "Se requieren al menos 3 años de datos",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  cor_test <- cor.test(datos$vel_viento_promedio, datos$n_incendios)
  r <- cor_test$estimate
  p_valor <- cor_test$p.value
  
  modelo <- lm(n_incendios ~ vel_viento_promedio, data = datos)
  datos$pred <- predict(modelo)
  
  signif_text <- if(p_valor < 0.001) "***" else if(p_valor < 0.01) "**" else if(p_valor < 0.05) "*" else ""
  
  fig <- plot_ly(datos) |>
    add_trace(
      x = ~vel_viento_promedio, y = ~n_incendios,
      type = "scatter", mode = "markers",
      marker = list(
        size = 14, color = ~anio,
        colorscale = "Viridis", showscale = TRUE,
        colorbar = list(title = "Año", tickformat = "d")
      ),
      text = ~anio,
      hovertemplate = "<b>Año: %{text}<\u002fb><br>Viento: %{x:.2f} m/s<br>Incendios: %{y:,.0f}<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~vel_viento_promedio, y = ~pred,
      type = "scatter", mode = "lines",
      name = "Regresión lineal",
      line = list(color = "#6f42c1", width = 2),
      hoverinfo = "skip"
    ) |>
    layout(
      title = list(
        text = paste0(titulo, "<br><sup>r = ", sprintf("%.3f", r), signif_text, " (p = ", sprintf("%.4f", p_valor), ")<\u002fsup>"),
        font = list(size = 14)
      ),
      xaxis = list(title = "Velocidad del viento (m/s)"),
      yaxis = list(title = "Cantidad de incendios", tickformat = ",.0f"),
      showlegend = FALSE,
      annotations = list(list(
        x = 1, y = 0,
        text = "* p<0.05, ** p<0.01, *** p<0.001",
        showarrow = FALSE, xref = "paper", yref = "paper",
        xanchor = "right", yanchor = "bottom",
        font = list(size = 10, color = "gray")
      )),
      margin = list(t = 70, r = 50, b = 60, l = 70)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de comparación de períodos para viento
output$grafico_comparacion_periodos_viento <- renderPlotly({
  datos <- filtrar_datos_anuales()
  
  periodo1 <- datos |> filter(periodo == "2001-2012")
  periodo2 <- datos |> filter(periodo == "2013-2024")
  
  if (nrow(periodo1) == 0 || nrow(periodo2) == 0) {
    return(
      plot_ly() |>
        layout(
          title = "Se requieren datos en ambos períodos",
          annotations = list(list(
            text = "Ajuste el rango de fechas para incluir ambos períodos",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  resumen <- datos |>
    group_by(periodo) |>
    summarise(
      incendios_prom = mean(n_incendios, na.rm = TRUE),
      incendios_sd = sd(n_incendios, na.rm = TRUE),
      viento_prom = mean(vel_viento_promedio, na.rm = TRUE),
      viento_sd = sd(vel_viento_promedio, na.rm = TRUE),
      n = n(),
      .groups = "drop"
    ) |>
    mutate(
      incendios_error = qt(0.975, n - 1) * incendios_sd / sqrt(n),
      viento_error = qt(0.975, n - 1) * viento_sd / sqrt(n)
    )
  
  cambio_inc <- ((resumen$incendios_prom[2] - resumen$incendios_prom[1]) / resumen$incendios_prom[1]) * 100
  cambio_viento <- ((resumen$viento_prom[2] - resumen$viento_prom[1]) / resumen$viento_prom[1]) * 100
  
  fig <- subplot(
    plot_ly(resumen) |>
      add_trace(
        x = ~periodo, y = ~incendios_prom,
        type = "bar", name = "Incendios",
        marker = list(color = c("#3498db", "#e74c3c")),
        error_y = list(type = "data", array = ~incendios_error, color = "black"),
        hovertemplate = "<b>%{x}<\u002fb><br>Promedio: %{y:.0f} incendios/año<extra><\u002fextra>"
      ) |>
      layout(
        yaxis = list(title = "Incendios promedio/año"),
        annotations = list(list(
          x = 0.5, y = 1.05,
          text = sprintf("Cambio: %+.1f%%", cambio_inc),
          showarrow = FALSE, xref = "paper", yref = "paper",
          font = list(size = 12, color = if(cambio_inc > 0) "red" else "green")
        ))
      ),
    plot_ly(resumen) |>
      add_trace(
        x = ~periodo, y = ~viento_prom,
        type = "bar", name = "Viento",
        marker = list(color = c("#6f42c1", "#9b59b6")),
        error_y = list(type = "data", array = ~viento_error, color = "black"),
        hovertemplate = "<b>%{x}<\u002fb><br>Viento: %{y:.2f} m/s<extra><\u002fextra>"
      ) |>
      layout(
        yaxis = list(title = "Velocidad promedio (m/s)"),
        annotations = list(list(
          x = 0.5, y = 1.05,
          text = sprintf("Cambio: %+.1f%%", cambio_viento),
          showarrow = FALSE, xref = "paper", yref = "paper",
          font = list(size = 12, color = if(cambio_viento > 0) "orange" else "green")
        ))
      ),
    nrows = 1, shareX = TRUE, titleX = FALSE
  ) |>
    layout(
      title = list(text = "Comparación entre períodos", font = list(size = 14)),
      showlegend = FALSE,
      margin = list(t = 70, b = 50)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de anomalías de velocidad del viento
output$grafico_anomalias_viento <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  if (nrow(datos) < 2) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes",
          annotations = list(list(
            text = "Seleccione un rango de fechas más amplio",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  # Calcular anomalía de viento
  datos <- datos |>
    mutate(
      viento_anomalia = vel_viento_promedio - mean(vel_viento_promedio, na.rm = TRUE)
    )
  
  rango_anomalia <- range(datos$viento_anomalia, na.rm = TRUE)
  datos <- datos |>
    mutate(
      incendios_escalados = scales::rescale(
        n_incendios, 
        to = c(rango_anomalia[1] * 0.8, rango_anomalia[2] * 0.8)
      )
    )
  
  fig <- plot_ly(datos) |>
    add_trace(
      x = ~anio, y = ~viento_anomalia,
      type = "bar",
      name = "Anomalía de viento",
      marker = list(
        # Más viento = naranja (puede propagar fuego), menos viento = verde
        color = ~ifelse(viento_anomalia > 0, "#fd7e14", "#28a745")
      ),
      hovertemplate = "<b>%{x}<\u002fb><br>Anomalía: %{y:+.2f} m/s<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~anio, y = ~incendios_escalados,
      type = "scatter", mode = "markers",
      name = "Incendios (escalados)",
      marker = list(
        size = ~scales::rescale(n_incendios, to = c(8, 20)),
        color = "black", symbol = "diamond",
        line = list(color = "white", width = 1)
      ),
      customdata = ~n_incendios,
      hovertemplate = "<b>%{x}<\u002fb><br>Incendios: %{customdata:,.0f}<extra><\u002fextra>"
    ) |>
    layout(
      title = list(
        text = paste("Anomalías de velocidad del viento -", titulo),
        font = list(size = 14)
      ),
      xaxis = list(title = "Año", dtick = 2),
      yaxis = list(
        title = "Anomalía de velocidad del viento (m/s)",
        zeroline = TRUE,
        zerolinecolor = "black",
        zerolinewidth = 1.5
      ),
      legend = list(orientation = "h", y = -0.15, x = 0.5, xanchor = "center"),
      barmode = "relative",
      margin = list(t = 50, b = 70)
    ) |>
    config(locale = "es")
  
  fig
})

# =============================================================================
# TARJETAS Y GRÁFICOS PARA ANÁLISIS DE DIRECCIÓN DEL VIENTO
# =============================================================================

# Función auxiliar para convertir grados a dirección cardinal
grados_a_cardinal <- function(grados) {
  direcciones <- c("N", "NE", "E", "SE", "S", "SO", "O", "NO", "N")
  indices <- round(grados / 45) + 1
  indices[indices > 8] <- 1
  direcciones[indices]
}

# Función auxiliar para calcular media circular
media_circular <- function(angulos_grados) {
  angulos_rad <- angulos_grados * pi / 180
  x_mean <- mean(cos(angulos_rad), na.rm = TRUE)
  y_mean <- mean(sin(angulos_rad), na.rm = TRUE)
  media_rad <- atan2(y_mean, x_mean)
  media_grados <- media_rad * 180 / pi
  if (media_grados < 0) media_grados <- media_grados + 360
  return(media_grados)
}

# Función auxiliar para calcular variabilidad circular (0-1, donde 0 = muy concentrado)
variabilidad_circular <- function(angulos_grados) {
  angulos_rad <- angulos_grados * pi / 180
  x_mean <- mean(cos(angulos_rad), na.rm = TRUE)
  y_mean <- mean(sin(angulos_rad), na.rm = TRUE)
  R <- sqrt(x_mean^2 + y_mean^2)  # Longitud del vector resultante (0-1)
  return(1 - R)  # Variabilidad: 0 = concentrado, 1 = disperso
}

# Función reactiva para datos de dirección por sector
filtrar_datos_direccion <- reactive({
  incendios_filtrados <- filtrar_incendios()
  
  # Crear sectores de 45 grados
  datos_direccion <- incendios_filtrados |>
    st_drop_geometry() |>
    mutate(
      direccion = X10M_WIND_DIRECTION_ACQ_DATE_MEAN,
      sector = cut(
        direccion,
        breaks = c(0, 45, 90, 135, 180, 225, 270, 315, 360),
        labels = c("N", "NE", "E", "SE", "S", "SO", "O", "NO"),
        include.lowest = TRUE, right = FALSE
      ),
      mes = month(acq_date),
      anio = year(acq_date)
    )
  
  return(datos_direccion)
})

# Tarjetas de métricas para dirección del viento
output$card_direccion_predominante <- renderUI({
  datos <- filtrar_datos_direccion()
  
  if (nrow(datos) < 1 || all(is.na(datos$direccion))) {
    return(HTML(crear_tarjeta("Sin datos", "#6c757d", "🧭")))
  }
  
  direccion_media <- media_circular(datos$direccion)
  cardinal <- grados_a_cardinal(direccion_media)
  valor <- sprintf("%s (%.0f°)", cardinal, direccion_media)
  
  HTML(crear_tarjeta(valor, "#6f42c1", "🧭"))
})

output$card_tendencia_incendios_direccion <- renderUI({
  datos <- filtrar_datos_anuales()
  
  if (nrow(datos) < 3) {
    return(HTML(crear_tarjeta("Sin datos", "#6c757d", "🔥")))
  }
  
  modelo <- lm(n_incendios ~ anio, data = datos)
  tendencia <- coef(modelo)[2] * 10
  
  valor <- sprintf("%+.0f /déc", tendencia)
  color <- if(tendencia <= 0) "#28a745" else "#dc3545"
  
  HTML(crear_tarjeta(valor, color, "🔥"))
})

output$card_variabilidad_direccion <- renderUI({
  datos <- filtrar_datos_direccion()
  
  if (nrow(datos) < 1 || all(is.na(datos$direccion))) {
    return(HTML(crear_tarjeta("Sin datos", "#6c757d", "🔄")))
  }
  
  variabilidad <- variabilidad_circular(datos$direccion)
  
  # Interpretar variabilidad
  interpretacion <- if(variabilidad < 0.3) {
    "Baja"
  } else if(variabilidad < 0.6) {
    "Media"
  } else {
    "Alta"
  }
  
  valor <- sprintf("%s (%.2f)", interpretacion, variabilidad)
  color <- if(variabilidad < 0.3) "#28a745" else if(variabilidad < 0.6) "#ffc107" else "#dc3545"
  
  HTML(crear_tarjeta(valor, color, "🔄"))
})

output$card_cambio_periodo_direccion <- renderUI({
  datos <- filtrar_datos_anuales()
  
  periodo1 <- datos |> filter(periodo == "2001-2012")
  periodo2 <- datos |> filter(periodo == "2013-2024")
  
  if (nrow(periodo1) == 0 || nrow(periodo2) == 0) {
    return(HTML(crear_tarjeta("Sin datos", "#6c757d", "↔️")))
  }
  
  prom1 <- mean(periodo1$n_incendios, na.rm = TRUE)
  prom2 <- mean(periodo2$n_incendios, na.rm = TRUE)
  cambio_pct <- ((prom2 - prom1) / prom1) * 100
  
  valor <- sprintf("%+.1f%%", cambio_pct)
  color <- if(cambio_pct > 10) "#dc3545" else if(cambio_pct < -10) "#28a745" else "#ffc107"
  
  HTML(crear_tarjeta(valor, color, "↔️"))
})

# Rosa de vientos con incendios
output$grafico_rosa_vientos <- renderPlotly({
  datos <- filtrar_datos_direccion()
  titulo <- titulo_area()
  
  if (nrow(datos) < 1 || all(is.na(datos$sector))) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes",
          annotations = list(list(
            text = "No hay datos de dirección del viento",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  # Contar incendios por sector
  resumen <- datos |>
    filter(!is.na(sector)) |>
    group_by(sector) |>
    summarise(n_incendios = n(), .groups = "drop") |>
    mutate(
      porcentaje = n_incendios / sum(n_incendios) * 100,
      angulo = c(0, 45, 90, 135, 180, 225, 270, 315)[match(sector, c("N", "NE", "E", "SE", "S", "SO", "O", "NO"))]
    )
  
  # Asegurar todos los sectores
  todos_sectores <- data.frame(
    sector = factor(c("N", "NE", "E", "SE", "S", "SO", "O", "NO"), 
                    levels = c("N", "NE", "E", "SE", "S", "SO", "O", "NO")),
    angulo = c(0, 45, 90, 135, 180, 225, 270, 315)
  )
  
  resumen <- todos_sectores |>
    left_join(resumen |> select(sector, n_incendios, porcentaje), by = "sector") |>
    mutate(
      n_incendios = coalesce(n_incendios, 0L),
      porcentaje = coalesce(porcentaje, 0)
    )
  
  # Gráfico polar (rosa de vientos)
  fig <- plot_ly(resumen) |>
    add_trace(
      type = "barpolar",
      r = ~porcentaje,
      theta = ~sector,
      name = "Incendios",
      marker = list(
        color = ~porcentaje,
        colorscale = list(c(0, "#fef0d9"), c(0.5, "#fdbb84"), c(1, "#b30000")),
        line = list(color = "white", width = 1)
      ),
      hovertemplate = "<b>%{theta}<\u002fb><br>Incendios: %{customdata:,.0f}<br>Porcentaje: %{r:.1f}%<extra><\u002fextra>",
      customdata = ~n_incendios
    ) |>
    layout(
      title = list(
        text = paste("Rosa de vientos (dirección durante incendios) -", titulo),
        font = list(size = 14)
      ),
      polar = list(
        angularaxis = list(
          direction = "clockwise",
          rotation = 90,
          tickfont = list(size = 12)
        ),
        radialaxis = list(
          title = "%",
          ticksuffix = "%"
        )
      ),
      showlegend = FALSE,
      margin = list(t = 60, b = 40)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de barras por sector
output$grafico_direccion_incendios <- renderPlotly({
  datos <- filtrar_datos_direccion()
  titulo <- titulo_area()
  
  if (nrow(datos) < 1 || all(is.na(datos$sector))) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes",
          annotations = list(list(
            text = "No hay datos de dirección del viento",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  # Resumen por sector con FRP promedio
  resumen <- datos |>
    filter(!is.na(sector)) |>
    group_by(sector) |>
    summarise(
      n_incendios = n(),
      frp_promedio = mean(frp, na.rm = TRUE),
      .groups = "drop"
    ) |>
    mutate(sector = factor(sector, levels = c("N", "NE", "E", "SE", "S", "SO", "O", "NO")))
  
  fig <- plot_ly(resumen) |>
    add_trace(
      x = ~sector, y = ~n_incendios,
      type = "bar",
      name = "Incendios",
      marker = list(color = "#e74c3c"),
      hovertemplate = "<b>%{x}<\u002fb><br>Incendios: %{y:,.0f}<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~sector, y = ~frp_promedio,
      type = "scatter", mode = "lines+markers",
      name = "FRP promedio (MW)",
      yaxis = "y2",
      line = list(color = "#fd7e14", width = 2),
      marker = list(size = 8, color = "#fd7e14"),
      hovertemplate = "<b>%{x}<\u002fb><br>FRP: %{y:.1f} MW<extra><\u002fextra>"
    ) |>
    layout(
      title = list(
        text = paste("Incendios y FRP por dirección del viento -", titulo),
        font = list(size = 14)
      ),
      xaxis = list(title = "Dirección del viento"),
      yaxis = list(title = "Cantidad de incendios", titlefont = list(color = "#e74c3c")),
      yaxis2 = list(
        title = "FRP promedio (MW)",
        overlaying = "y", side = "right",
        titlefont = list(color = "#fd7e14"),
        tickfont = list(color = "#fd7e14")
      ),
      legend = list(orientation = "h", y = -0.2, x = 0.5, xanchor = "center"),
      margin = list(t = 50, b = 80)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico temporal de dirección
output$grafico_direccion_temporal <- renderPlotly({
  datos <- filtrar_datos_direccion()
  titulo <- titulo_area()
  
  if (nrow(datos) < 1) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes",
          annotations = list(list(
            text = "No hay datos disponibles",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  # Calcular dirección media por año
  resumen_anual <- datos |>
    filter(!is.na(direccion)) |>
    group_by(anio) |>
    summarise(
      direccion_media = media_circular(direccion),
      n_incendios = n(),
      variabilidad = variabilidad_circular(direccion),
      .groups = "drop"
    ) |>
    mutate(cardinal = grados_a_cardinal(direccion_media))
  
  fig <- plot_ly(resumen_anual) |>
    add_trace(
      x = ~anio, y = ~direccion_media,
      type = "scatter", mode = "lines+markers",
      name = "Dirección media (°)",
      line = list(color = "#6f42c1", width = 2),
      marker = list(size = 10, color = "#6f42c1"),
      text = ~cardinal,
      hovertemplate = "<b>%{x}<\u002fb><br>Dirección: %{y:.0f}° (%{text})<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~anio, y = ~n_incendios,
      type = "bar",
      name = "Incendios",
      yaxis = "y2",
      marker = list(color = "#e74c3c", opacity = 0.5),
      hovertemplate = "<b>%{x}<\u002fb><br>Incendios: %{y:,.0f}<extra><\u002fextra>"
    ) |>
    layout(
      title = list(
        text = paste("Dirección media del viento por año -", titulo),
        font = list(size = 14)
      ),
      xaxis = list(title = "Año", dtick = 2),
      yaxis = list(
        title = "Dirección media (°)",
        range = c(0, 360),
        tickvals = c(0, 90, 180, 270, 360),
        ticktext = c("N (0°)", "E (90°)", "S (180°)", "O (270°)", "N (360°)"),
        titlefont = list(color = "#6f42c1")
      ),
      yaxis2 = list(
        title = "Cantidad de incendios",
        overlaying = "y", side = "right",
        titlefont = list(color = "#e74c3c")
      ),
      legend = list(orientation = "h", y = -0.2, x = 0.5, xanchor = "center"),
      barmode = "overlay",
      margin = list(t = 50, b = 80)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico mensual de dirección
output$grafico_direccion_mensual <- renderPlotly({
  datos <- filtrar_datos_direccion()
  titulo <- titulo_area()
  
  if (nrow(datos) < 1) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes",
          annotations = list(list(
            text = "No hay datos disponibles",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  # Calcular dirección media por mes
  meses_nombres <- c("Ene", "Feb", "Mar", "Abr", "May", "Jun", 
                     "Jul", "Ago", "Sep", "Oct", "Nov", "Dic")
  
  resumen_mensual <- datos |>
    filter(!is.na(direccion)) |>
    group_by(mes) |>
    summarise(
      direccion_media = media_circular(direccion),
      n_incendios = n(),
      .groups = "drop"
    ) |>
    mutate(
      mes_nombre = factor(meses_nombres[mes], levels = meses_nombres),
      cardinal = grados_a_cardinal(direccion_media)
    )
  
  fig <- plot_ly(resumen_mensual) |>
    add_trace(
      x = ~mes_nombre, y = ~n_incendios,
      type = "bar",
      name = "Incendios",
      marker = list(color = "#e74c3c"),
      hovertemplate = "<b>%{x}<\u002fb><br>Incendios: %{y:,.0f}<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~mes_nombre, y = ~direccion_media,
      type = "scatter", mode = "lines+markers",
      name = "Dirección media (°)",
      yaxis = "y2",
      line = list(color = "#6f42c1", width = 2),
      marker = list(size = 10, color = "#6f42c1"),
      text = ~cardinal,
      hovertemplate = "<b>%{x}<\u002fb><br>Dirección: %{y:.0f}° (%{text})<extra><\u002fextra>"
    ) |>
    layout(
      title = list(
        text = paste("Incendios y dirección del viento por mes -", titulo),
        font = list(size = 14)
      ),
      xaxis = list(title = "Mes"),
      yaxis = list(title = "Cantidad de incendios", titlefont = list(color = "#e74c3c")),
      yaxis2 = list(
        title = "Dirección media (°)",
        overlaying = "y", side = "right",
        range = c(0, 360),
        tickvals = c(0, 90, 180, 270, 360),
        ticktext = c("N", "E", "S", "O", "N"),
        titlefont = list(color = "#6f42c1")
      ),
      legend = list(orientation = "h", y = -0.2, x = 0.5, xanchor = "center"),
      margin = list(t = 50, b = 80)
    ) |>
    config(locale = "es")
  
  fig
})

# =============================================================================
# TARJETAS Y GRÁFICOS PARA ANÁLISIS INTEGRADO
# =============================================================================

# Tarjetas de resumen para análisis integrado
output$card_resumen_temp <- renderUI({
  metricas <- calcular_metricas()
  
  if(is.na(metricas$tendencia_temp)) {
    return(HTML(crear_tarjeta("Sin datos", "#6c757d", "🌡️")))
  }
  
  tendencia <- metricas$tendencia_temp
  signo <- if(tendencia > 0) "↑" else "↓"
  color <- if(tendencia > 0) "#dc3545" else "#17a2b8"
  valor <- sprintf("%s %+.2f°C/déc", signo, tendencia)
  
  HTML(crear_tarjeta(valor, color, "🌡️"))
})

output$card_resumen_precip <- renderUI({
  metricas <- calcular_metricas_precip()
  
  if(is.na(metricas$tendencia_precip)) {
    return(HTML(crear_tarjeta("Sin datos", "#6c757d", "🌧️")))
  }
  
  tendencia <- metricas$tendencia_precip
  signo <- if(tendencia > 0) "↑" else "↓"
  # Menos lluvia es preocupante
  color <- if(tendencia < 0) "#dc3545" else "#17a2b8"
  valor <- sprintf("%s %+.2f mm/déc", signo, tendencia)
  
  HTML(crear_tarjeta(valor, color, "🌧️"))
})

output$card_resumen_viento <- renderUI({
  metricas <- calcular_metricas_viento()
  
  if(is.na(metricas$tendencia_viento)) {
    return(HTML(crear_tarjeta("Sin datos", "#6c757d", "💨")))
  }
  
  tendencia <- metricas$tendencia_viento
  signo <- if(tendencia > 0) "↑" else "↓"
  color <- if(tendencia > 0) "#fd7e14" else "#28a745"
  valor <- sprintf("%s %+.2f m/s/déc", signo, tendencia)
  
  HTML(crear_tarjeta(valor, color, "💨"))
})

output$card_resumen_incendios <- renderUI({
  metricas <- calcular_metricas()
  
  if(is.na(metricas$tendencia_incendios)) {
    return(HTML(crear_tarjeta("Sin datos", "#6c757d", "🔥")))
  }
  
  tendencia <- metricas$tendencia_incendios
  signo <- if(tendencia > 0) "↑" else "↓"
  color <- if(tendencia > 0) "#dc3545" else "#28a745"
  valor <- sprintf("%s %+.0f/déc", signo, tendencia)
  
  HTML(crear_tarjeta(valor, color, "🔥"))
})

output$card_correlacion_maxima <- renderUI({
  datos <- filtrar_datos_anuales()
  
  if(nrow(datos) < 3) {
    return(HTML(crear_tarjeta("Sin datos", "#6c757d", "🔗")))
  }
  
  # Calcular correlaciones con incendios
  cor_temp <- cor(datos$temp_promedio, datos$n_incendios, use = "complete.obs")
  cor_precip <- cor(datos$precip_promedio, datos$n_incendios, use = "complete.obs")
  cor_viento <- cor(datos$vel_viento_promedio, datos$n_incendios, use = "complete.obs")
  
  correlaciones <- c(
    "Temp" = cor_temp,
    "Precip" = cor_precip,
    "Viento" = cor_viento
  )
  
  # Encontrar la más fuerte (en valor absoluto)
  idx_max <- which.max(abs(correlaciones))
  nombre_max <- names(correlaciones)[idx_max]
  valor_max <- correlaciones[idx_max]
  
  icono <- switch(nombre_max,
    "Temp" = "🌡️",
    "Precip" = "🌧️",
    "Viento" = "💨"
  )
  
  color <- if(abs(valor_max) > 0.5) "#ffc107" else "#6c757d"
  valor <- sprintf("%s r=%.2f", nombre_max, valor_max)
  
  HTML(crear_tarjeta(valor, color, icono))
})

# Matriz de correlación
output$grafico_matriz_correlacion <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  if(nrow(datos) < 3) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes",
          annotations = list(list(
            text = "Se requieren al menos 3 años de datos",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  # Seleccionar variables para la matriz
  vars_matriz <- datos |>
    select(
      Incendios = n_incendios,
      Temperatura = temp_promedio,
      Precipitación = precip_promedio,
      Viento = vel_viento_promedio,
      FRP = frp_promedio
    )
  
  # Calcular matriz de correlación
  mat_cor <- cor(vars_matriz, use = "pairwise.complete.obs")
  
  # Crear heatmap
  fig <- plot_ly(
    x = colnames(mat_cor),
    y = rownames(mat_cor),
    z = mat_cor,
    type = "heatmap",
    colorscale = list(
      list(0, "#2166ac"),
      list(0.5, "#f7f7f7"),
      list(1, "#b2182b")
    ),
    zmin = -1, zmax = 1,
    hovertemplate = "%{y} vs %{x}<br>r = %{z:.3f}<extra><\u002fextra>"
  )
  
  # Agregar valores de texto
  for(i in 1:nrow(mat_cor)) {
    for(j in 1:ncol(mat_cor)) {
      fig <- fig |>
        add_annotations(
          x = colnames(mat_cor)[j],
          y = rownames(mat_cor)[i],
          text = sprintf("%.2f", mat_cor[i,j]),
          showarrow = FALSE,
          font = list(
            size = 11,
            color = if(abs(mat_cor[i,j]) > 0.5) "white" else "black"
          )
        )
    }
  }
  
  fig <- fig |>
    layout(
      title = list(
        text = paste("Matriz de correlación -", titulo),
        font = list(size = 14)
      ),
      xaxis = list(title = "", tickangle = 45),
      yaxis = list(title = "", autorange = "reversed"),
      margin = list(t = 60, b = 100, l = 100)
    ) |>
    colorbar(title = "r", tickvals = c(-1, -0.5, 0, 0.5, 1)) |>
    config(locale = "es")
  
  fig
})

# Gráfico de interacción temperatura × precipitación
output$grafico_interaccion_temp_precip <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  if(nrow(datos) < 3) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes",
          annotations = list(list(
            text = "Se requieren al menos 3 años de datos",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  # Clasificar años por cuadrante
  temp_media <- mean(datos$temp_promedio, na.rm = TRUE)
  precip_media <- mean(datos$precip_promedio, na.rm = TRUE)
  
  datos <- datos |>
    mutate(
      cuadrante = case_when(
        temp_promedio >= temp_media & precip_promedio < precip_media ~ "Cálido y seco",
        temp_promedio >= temp_media & precip_promedio >= precip_media ~ "Cálido y húmedo",
        temp_promedio < temp_media & precip_promedio < precip_media ~ "Frío y seco",
        TRUE ~ "Frío y húmedo"
      )
    )
  
  # Escalar tamaño de puntos
  inc_min <- min(datos$n_incendios)
  inc_max <- max(datos$n_incendios)
  datos$size_scaled <- 10 + (datos$n_incendios - inc_min) / (inc_max - inc_min) * 30
  
  colores_cuadrante <- c(
    "Cálido y seco" = "#dc3545",
    "Cálido y húmedo" = "#fd7e14",
    "Frío y seco" = "#6c757d",
    "Frío y húmedo" = "#17a2b8"
  )
  
  fig <- plot_ly(datos) |>
    add_trace(
      x = ~temp_promedio,
      y = ~precip_promedio,
      type = "scatter",
      mode = "markers+text",
      color = ~cuadrante,
      colors = colores_cuadrante,
      marker = list(
        size = ~size_scaled,
        line = list(color = "white", width = 1),
        opacity = 0.8
      ),
      text = ~anio,
      textposition = "middle center",
      textfont = list(size = 8, color = "white"),
      hovertemplate = paste0(
        "<b>Año: %{text}<\u002fb><br>",
        "Temp: %{x:.1f}°C<br>",
        "Precip: %{y:.2f} mm<br>",
        "Incendios: %{customdata:,.0f}",
        "<extra><\u002fextra>"
      ),
      customdata = ~n_incendios
    ) |>
    # Líneas de referencia
    add_segments(
      x = temp_media, xend = temp_media,
      y = min(datos$precip_promedio) * 0.95, yend = max(datos$precip_promedio) * 1.05,
      line = list(color = "gray", dash = "dash", width = 1),
      showlegend = FALSE, hoverinfo = "skip"
    ) |>
    add_segments(
      x = min(datos$temp_promedio) * 0.99, xend = max(datos$temp_promedio) * 1.01,
      y = precip_media, yend = precip_media,
      line = list(color = "gray", dash = "dash", width = 1),
      showlegend = FALSE, hoverinfo = "skip"
    ) |>
    layout(
      title = list(
        text = paste("Interacción clima-incendios -", titulo, "<br><sup>Tamaño = cantidad de incendios<\u002fsup>"),
        font = list(size = 13)
      ),
      xaxis = list(title = "Temperatura promedio (°C)"),
      yaxis = list(title = "Precipitación promedio (mm)"),
      legend = list(orientation = "h", y = -0.15, x = 0.5, xanchor = "center"),
      margin = list(t = 70, b = 80)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de tendencias normalizadas
output$grafico_tendencias_multiples <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  if(nrow(datos) < 2) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes",
          annotations = list(list(
            text = "Seleccione un rango de fechas más amplio",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  # Normalizar variables (z-score)
  datos_norm <- datos |>
    mutate(
      temp_norm = (temp_promedio - mean(temp_promedio, na.rm = TRUE)) / sd(temp_promedio, na.rm = TRUE),
      precip_norm = (precip_promedio - mean(precip_promedio, na.rm = TRUE)) / sd(precip_promedio, na.rm = TRUE),
      viento_norm = (vel_viento_promedio - mean(vel_viento_promedio, na.rm = TRUE)) / sd(vel_viento_promedio, na.rm = TRUE),
      incendios_norm = (n_incendios - mean(n_incendios, na.rm = TRUE)) / sd(n_incendios, na.rm = TRUE)
    )
  
  fig <- plot_ly(datos_norm) |>
    add_trace(
      x = ~anio, y = ~temp_norm,
      type = "scatter", mode = "lines+markers",
      name = "Temperatura",
      line = list(color = "#e74c3c", width = 2),
      marker = list(size = 6, color = "#e74c3c"),
      hovertemplate = "<b>%{x}<\u002fb><br>Temp (z): %{y:.2f}<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~anio, y = ~precip_norm,
      type = "scatter", mode = "lines+markers",
      name = "Precipitación",
      line = list(color = "#17a2b8", width = 2),
      marker = list(size = 6, color = "#17a2b8"),
      hovertemplate = "<b>%{x}<\u002fb><br>Precip (z): %{y:.2f}<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~anio, y = ~viento_norm,
      type = "scatter", mode = "lines+markers",
      name = "Viento",
      line = list(color = "#6f42c1", width = 2),
      marker = list(size = 6, color = "#6f42c1"),
      hovertemplate = "<b>%{x}<\u002fb><br>Viento (z): %{y:.2f}<extra><\u002fextra>"
    ) |>
    add_trace(
      x = ~anio, y = ~incendios_norm,
      type = "scatter", mode = "lines+markers",
      name = "Incendios",
      line = list(color = "#fd7e14", width = 3),
      marker = list(size = 8, color = "#fd7e14"),
      hovertemplate = "<b>%{x}<\u002fb><br>Incendios (z): %{y:.2f}<extra><\u002fextra>"
    ) |>
    layout(
      title = list(
        text = paste("Variables normalizadas (z-score) -", titulo),
        font = list(size = 14)
      ),
      xaxis = list(title = "Año", dtick = 2),
      yaxis = list(
        title = "Valor estandarizado (z-score)",
        zeroline = TRUE,
        zerolinecolor = "black",
        zerolinewidth = 1
      ),
      legend = list(orientation = "h", y = -0.15, x = 0.5, xanchor = "center"),
      hovermode = "x unified",
      margin = list(t = 50, b = 80)
    ) |>
    config(locale = "es")
  
  fig
})

# Gráfico de condiciones de riesgo
output$grafico_condiciones_riesgo <- renderPlotly({
  datos <- filtrar_datos_anuales()
  titulo <- titulo_area()
  
  if(nrow(datos) < 3) {
    return(
      plot_ly() |>
        layout(
          title = "Datos insuficientes",
          annotations = list(list(
            text = "Se requieren al menos 3 años de datos",
            x = 0.5, y = 0.5, xref = "paper", yref = "paper",
            showarrow = FALSE, font = list(size = 14)
          ))
        )
    )
  }
  
  # Calcular índice de riesgo compuesto
  # Alta temp + baja precip + alto viento = alto riesgo
  datos <- datos |>
    mutate(
      temp_score = (temp_promedio - min(temp_promedio)) / (max(temp_promedio) - min(temp_promedio)),
      precip_score = 1 - (precip_promedio - min(precip_promedio)) / (max(precip_promedio) - min(precip_promedio)),
      viento_score = (vel_viento_promedio - min(vel_viento_promedio)) / (max(vel_viento_promedio) - min(vel_viento_promedio)),
      indice_riesgo = (temp_score + precip_score + viento_score) / 3,
      categoria_riesgo = case_when(
        indice_riesgo >= 0.66 ~ "Alto",
        indice_riesgo >= 0.33 ~ "Medio",
        TRUE ~ "Bajo"
      )
    )
  
  colores_riesgo <- c("Bajo" = "#28a745", "Medio" = "#ffc107", "Alto" = "#dc3545")
  
  fig <- plot_ly(datos) |>
    add_trace(
      x = ~anio, y = ~indice_riesgo,
      type = "bar",
      color = ~categoria_riesgo,
      colors = colores_riesgo,
      hovertemplate = paste0(
        "<b>%{x}<\u002fb><br>",
        "Índice de riesgo: %{y:.2f}<br>",
        "Incendios: %{customdata:,.0f}",
        "<extra><\u002fextra>"
      ),
      customdata = ~n_incendios
    ) |>
    add_trace(
      x = ~anio, y = ~scales::rescale(n_incendios, to = c(0, 1)),
      type = "scatter", mode = "lines+markers",
      name = "Incendios (escalados)",
      line = list(color = "black", width = 2),
      marker = list(size = 8, color = "black"),
      hovertemplate = "<b>%{x}<\u002fb><br>Incendios: %{customdata:,.0f}<extra><\u002fextra>",
      customdata = ~n_incendios
    ) |>
    layout(
      title = list(
        text = paste("Índice de riesgo climático -", titulo, "<br><sup>Combina: temperatura (+), precipitación (-), viento (+)<\u002fsup>"),
        font = list(size = 13)
      ),
      xaxis = list(title = "Año", dtick = 2),
      yaxis = list(
        title = "Índice de riesgo (0-1)",
        range = c(0, 1.1)
      ),
      legend = list(orientation = "h", y = -0.15, x = 0.5, xanchor = "center"),
      barmode = "overlay",
      margin = list(t = 70, b = 80)
    ) |>
    config(locale = "es")
  
  fig
})

# =============================================================================
# OUTPUTS EXISTENTES (del dashboard original)
# =============================================================================

# Gráfico interactivo de cantidad de incendios por AC
output$grafico_cantidad_incendios_ac <- renderPlotly({
  ac_incendios_filtradas <- filtrar_ac_incendios()
  
  # Definir el gráfico ggplot2
  g <- ac_incendios_filtradas |>
    ggplot(aes(x = reorder(nombre_ac, incendios_n), y = incendios_n)) +
    geom_col(fill = "darkred") +
    xlab("AC") +
    ylab("Cantidad de incendios") +
    coord_flip() +
    theme_minimal()
  
  # Convertir a plotly y agregar tooltip personalizado
  ggplotly(g, tooltip = c("x", "y")) |> 
    style(
      hovertemplate = paste(
        '%{y}<br>',
        'Incendios: %{x:.0f}<br>',
        '<extra><\u002fextra>'
      )
    ) |>
    config(locale = 'es')
})

# Gráfico interactivo de cantidad de incendios por ASP
output$grafico_cantidad_incendios_asp <- renderPlotly({
  asp_incendios_filtradas <- filtrar_asp_incendios()
  
  # Definir el gráfico ggplot2
  g <- asp_incendios_filtradas |>
    ggplot(aes(x = reorder(nombre_asp, incendios_n), y = incendios_n)) +
    geom_col(fill = "darkgreen") +
    xlab("ASP") +
    ylab("Cantidad de incendios") +
    coord_flip() +
    theme_minimal()
  
  # Convertir a plotly con tooltip personalizado
  ggplotly(g, tooltip = c("x", "y")) |> 
    style(
      hovertemplate = paste(
        '%{y}<br>',
        'Incendios: %{x:.0f}<br>',
        '<extra><\u002fextra>'
      )
    ) |>
    config(locale = 'es')
})

# Tabla de registros
output$tabla_registros_incendios <- renderDataTable({
  incendios_filtrados <- filtrar_incendios()
  
  incendios_filtrados |>
    st_drop_geometry() |>
    select(
      AC = nombre_ac,
      ASP = nombre_asp,
      Fecha = acq_date,
      Hora = acq_time,
      `FRP (MW)` = frp,
      Brillantez = brightness,
      Confianza = confidence,
      `Temp. (°C)` = TEMPERATURE_2M_ACQ_DATE_MEAN,
      `Prec. (mm)` = PRECIPITATION_ACQ_DATE_SUM,
      `Vel. viento (m/s)` = X10M_WIND_SPEED_ACQ_DATE_MEAN,
      `Dir. viento (°)` = X10M_WIND_DIRECTION_ACQ_DATE_MEAN
    ) |>
    mutate(
      across(c(`Temp. (°C)`, `Prec. (mm)`, `Vel. viento (m/s)`, `Dir. viento (°)`),
             ~ round(.x, 1))
    ) |>
    arrange(desc(Fecha))
},
options = list(
  pageLength = 10,
  language = list(
    url = "//cdn.datatables.net/plug-ins/1.10.25/i18n/Spanish.json"
  )
))

# Gráfico interactivo de cantidad de incendios por año
output$grafico_cantidad_incendios_anio <- renderPlotly({
  # Filtrar el conjunto de datos
  incendios_filtrados <- filtrar_incendios()
  
  # Incendios agrupados por año
  incendios_por_anio <-
    incendios_filtrados |>
    mutate(anio = year(acq_date)) |>
    group_by(anio) |>
    summarize(
      n = n(),
      .groups = "drop"
    )
  
  # Obtener los límites del eje x basados en los datos filtrados
  anio_minimo <- year(min(incendios_filtrados$acq_date, na.rm = TRUE))
  anio_maximo <- year(max(incendios_filtrados$acq_date, na.rm = TRUE))
  lim_x <- c(anio_minimo, anio_maximo)
  
  # Serie base con tooltips
  serie_na <-
    incendios_por_anio |>
    dplyr::arrange(anio) |>
    dplyr::mutate(
      tt_n = paste0(
        "Año: ", anio,
        "<br>Cantidad de incendios: ", scales::comma(n)
      )
    )
  
  # Datos para líneas de tendencia (ignorar NA)
  df_n <- tidyr::drop_na(serie_na, n)
  
  # Solo crear línea de tendencia si hay al menos 2 puntos
  if (nrow(df_n) > 1) {
    pred_n <- tibble::tibble(
      anio = df_n$anio,
      yhat = predict(stats::lm(n ~ anio, data = df_n), newdata = df_n)
    )
  } else {
    pred_n <- NULL
  }
  
  # Plotly con línea de incendios
  fig <- plotly::plot_ly() |>
    plotly::add_lines(
      data = serie_na,
      x = ~anio, y = ~n,
      name = "Cantidad de incendios",
      line = list(color = "red", width = 2),
      hovertemplate = ~tt_n
    )
  
  # Agregar línea de tendencia solo si existe
  if (!is.null(pred_n)) {
    fig <- fig |>
      plotly::add_lines(
        data = pred_n, x = ~anio, y = ~yhat,
        name = "Tendencia",
        showlegend = TRUE,
        line = list(color = "red", dash = "dash", width = 1),
        hovertemplate = paste0(
        "Tendencia",
        "<br>Año: %{x}",
        "<br>Valor: %{y:,.0f}",
        "<extra><\u002fextra>"
      )
      )
  }
  
  # Configurar el layout con límites del eje x dinámicos
  fig <- fig |>
    plotly::layout(
      xaxis = list(
        title = "Año",
        range = lim_x,  # aplicar los límites dinámicos
        dtick = 1       # mostrar cada año
      ),
      yaxis = list(
        title = "Cantidad de incendios",
        tickformat = ",.0f",
        automargin = TRUE
      ),
      legend = list(orientation = "h", x = 0, y = 1.15),
      margin = list(t = 90, r = 80, b = 60, l = 60)
    ) |>
    plotly::config(locale = "es", displayModeBar = TRUE)

  fig
})

# Gráfico interactivo de cantidad de incendios por año
output$grafico_cantidad_incendios_anio_mes <- renderPlotly({
  # Filtrar el conjunto de datos
  incendios_filtrados <- filtrar_incendios()
  
  # Incendios agrupados por año y mes
  incendios_por_anio_mes <-
    incendios_filtrados |>
    mutate(
      anio = year(acq_date),
      mes  = month(acq_date, label = TRUE, abbr = TRUE)
    ) |>
    group_by(anio, mes) |>
    summarize(n = n(), .groups = "drop")

  # Asegurar que los meses queden en orden enero-diciembre
  incendios_por_anio_mes$mes <- factor(
    incendios_por_anio_mes$mes,
    levels = month(ymd("2025-01-01") + months(0:11), label = TRUE, abbr = TRUE)
  )
  
  # Traducir las abreviaturas de los meses a español
  incendios_por_anio_mes <-
    incendios_por_anio_mes |>
      mutate(
        mes = factor(
          mes,
          levels = month.abb,
          labels = c("Ene", "Feb", "Mar", "Abr", "May", "Jun",
                     "Jul", "Ago", "Sep", "Oct", "Nov", "Dic")
        )
      )
  
  # Heatmap
  g <-
    ggplot(
      incendios_por_anio_mes,
      aes(
        x = mes,
        y = factor(anio),
        fill = n,
        text = paste0(
          "Año: ", anio,
          "<br>Mes: ", mes,
          "<br>Cantidad de incendios: ", n
        )
      )
    ) +
    geom_tile(color = "white") +
    scale_fill_viridis_c(name = "Incendios", option = "inferno", direction = -1) +
    labs(
      x = "Mes",
      y = "Año"
    ) +
    theme_minimal(base_size = 10) +
    theme(
      panel.grid = element_blank(),
      axis.text.x = element_text(angle = 45, hjust = 1)
    )
  
  # Convertir a gráfico interactivo plotly
  g_interactivo <- 
   ggplotly(g, tooltip = "text") |> 
   config(locale = 'es')
  
  # Mostrar gráfico
  # g
  g_interactivo
  
})
  
# Mapa interactivo
output$mapa <- renderTmap({
  # Filtrar conjuntos de datos
  incendios_filtrados <- filtrar_incendios() |>
    mutate(
      across(
        c(TEMPERATURE_2M_ACQ_DATE_MEAN, PRECIPITATION_ACQ_DATE_SUM,
          X10M_WIND_SPEED_ACQ_DATE_MEAN, X10M_WIND_DIRECTION_ACQ_DATE_MEAN),
        ~ round(.x, 1)
      )
    )
  ac_incendios_filtradas  <- filtrar_ac_incendios()
  asp_incendios_filtradas <- filtrar_asp_incendios()
  
  # Mapa base
  mapa <- tm_basemap(c(
    "CartoDB.Positron", 
    "OpenStreetMap", 
    "Esri.WorldImagery"
  ))
    
  # Agregar capa de AC solo si hay datos
  if (nrow(ac_incendios_filtradas) > 0) {
    # Verificar variabilidad en los datos
    valores_unicos_ac <- length(unique(ac_incendios_filtradas$incendios_n))
    max_valor_ac <- max(ac_incendios_filtradas$incendios_n, na.rm = TRUE)
    
    if (valores_unicos_ac > 1 && max_valor_ac > 0) {
      # Si hay variación y no todos son 0, usar escala de intervalos
      mapa <- mapa +
        tm_shape(ac_incendios_filtradas, name = "AC") +
          tm_polygons(
            fill = "incendios_n",
            fill.scale = tm_scale_intervals(
              style = "pretty", 
              values = "brewer.reds",
              n = min(5, valores_unicos_ac)
            ),
            fill.legend = tm_legend(title = "Incendios en AC"),
            fill_alpha = 0.3,
            id = "nombre_ac",
            popup.vars = c("AC" = "nombre_ac", "Incendios" = "incendios_n")
          ) +
          tm_borders(col = "black", lwd = 1.5)
    } else {
      # Si todos los valores son iguales o todos son 0, usar color fijo
      mapa <- mapa +
        tm_shape(ac_incendios_filtradas, name = "AC") +
          tm_polygons(
            fill = "#fee5d9", # color fijo (rojo muy claro)
            fill_alpha = 0.3,
            id = "nombre_ac",
            popup.vars = c("AC" = "nombre_ac", "Incendios" = "incendios_n")
          ) +
          tm_borders(col = "black", lwd = 1.5)
    }
  }
  
  # Agregar capa de ASP solo si hay datos
  if (nrow(asp_incendios_filtradas) > 0) {
    # Verificar variabilidad en los datos
    valores_unicos_asp <- length(unique(asp_incendios_filtradas$incendios_n))
    max_valor_asp <- max(asp_incendios_filtradas$incendios_n, na.rm = TRUE)
    
    if (valores_unicos_asp > 1 && max_valor_asp > 0) {
      # Si hay variación y no todos son 0, usar escala de intervalos
      mapa <- mapa +
        tm_shape(asp_incendios_filtradas, name = "ASP") +
          tm_polygons(
            fill = "incendios_n",
            fill.scale = tm_scale_intervals(
              style = "pretty", 
              values = "brewer.greens",
              n = min(5, valores_unicos_asp)
            ),
            fill.legend = tm_legend(title = "Incendios en ASP"),
            fill_alpha = 0.4,
            id = "nombre_asp",
            popup.vars = c("ASP" = "nombre_asp", "Incendios" = "incendios_n")
          ) +
          tm_borders(col = "darkblue", lwd = 1.2)
    } else {
      # Si todos los valores son iguales o todos son 0, usar color fijo
      mapa <- mapa +
        tm_shape(asp_incendios_filtradas, name = "ASP") +
          tm_polygons(
            fill = "#e5f5e0", # color fijo (verde muy claro)
            fill_alpha = 0.4,
            id = "nombre_asp",
            popup.vars = c("ASP" = "nombre_asp", "Incendios" = "incendios_n")
          ) +
          tm_borders(col = "darkblue", lwd = 1.2)
    }
  }

  # Agregar capa de incendios solo si hay datos
  if (nrow(incendios_filtrados) > 0) {
    # Verificar variabilidad en FRP
    valores_unicos_frp <- length(unique(incendios_filtrados$frp))
    
    if (valores_unicos_frp > 1) {
      # Si hay variación en FRP, usar escala de intervalos
      mapa <- mapa +
        tm_shape(incendios_filtrados, name = "Incendios") +
        tm_dots(
          fill = "frp",
          fill.scale = tm_scale_intervals(
            style = "quantile",
            values = "inferno",
            n = min(5, valores_unicos_frp)
          ),
          fill.legend = tm_legend(title = "FRP (MW)"),
          size = 0.5,
          popup.vars = c(
            "AC" = "nombre_ac", "ASP" = "nombre_asp",            
            "Fecha" = "acq_date", "Hora" = "acq_time",
            "FRP (MW)" = "frp", "Brillantez" = "brightness",
            "Confianza" = "confidence", 
            "Temperatura a 2m (°C)" = "TEMPERATURE_2M_ACQ_DATE_MEAN",
            "Precipitación (mm)" = "PRECIPITATION_ACQ_DATE_SUM",
            "Velocidad del viento (m/s)" = "X10M_WIND_SPEED_ACQ_DATE_MEAN",
            "Dirección del viento (°)" = "X10M_WIND_DIRECTION_ACQ_DATE_MEAN"
          )
        )
    } else {
      # Si todos los valores de FRP son iguales, usar color fijo
      mapa <- mapa +
        tm_shape(incendios_filtrados, name = "Incendios") +
          tm_dots(
            fill = "red",  
            size = 0.5,
            popup.vars = c(
            "AC" = "nombre_ac", "ASP" = "nombre_asp",            
            "Fecha" = "acq_date", "Hora" = "acq_time",
            "FRP (MW)" = "frp", "Brillantez" = "brightness",
            "Confianza" = "confidence", 
            "Temperatura a 2m (°C)" = "TEMPERATURE_2M_ACQ_DATE_MEAN",
            "Precipitación (mm)" = "PRECIPITATION_ACQ_DATE_SUM",
            "Velocidad del viento (m/s)" = "X10M_WIND_SPEED_ACQ_DATE_MEAN",
            "Dirección del viento (°)" = "X10M_WIND_DIRECTION_ACQ_DATE_MEAN"
            )
          )
    }
  }
  
  # Agregar elementos de control del mapa
  mapa +
    tm_scalebar(position = c("left", "bottom")) +
    tm_compass(position = c("right", "top"))
})
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-js"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/bootstrap-datepicker.min.js"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["<script>(function() {\n        var datepicker = $.fn.datepicker.noConflict();\n        $.fn.bsDatepicker = datepicker;\n      })();\n     <\/script>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap-datepicker-css"]},{"type":"character","attributes":{},"value":["1.9.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/datepicker"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/bootstrap-datepicker3.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.10.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leaflet"]},{"type":"character","attributes":{},"value":["1.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet.js"]},{"type":"character","attributes":{},"value":["leaflet.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leafletfix"]},{"type":"character","attributes":{},"value":["1.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/leafletfix"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leafletfix.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["proj4"]},{"type":"character","attributes":{},"value":["2.6.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/plugins/Proj4Leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["proj4.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["Proj4Leaflet"]},{"type":"character","attributes":{},"value":["1.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/plugins/Proj4Leaflet"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["proj4leaflet.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["rstudio_leaflet"]},{"type":"character","attributes":{},"value":["1.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/lib/rstudio_leaflet"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rstudio_leaflet.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["leaflet-binding"]},{"type":"character","attributes":{},"value":["2.2.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/assets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["leaflet"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["2.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["datatables-css"]},{"type":"character","attributes":{},"value":["0.0.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets/css"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["datatables-crosstalk.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["DT"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.33"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["datatables-binding"]},{"type":"character","attributes":{},"value":["0.33"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["datatables.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["DT"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.33"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.5.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["crosstalk"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["crosstalk"]},{"type":"character","attributes":{},"value":["1.2.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/crosstalk.min.js"]},{"type":"character","attributes":{},"value":["css/crosstalk.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["crosstalk"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.2.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"character","attributes":{},"value":["1.6.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmlwidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.6.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["plotly-binding"]},{"type":"character","attributes":{},"value":["4.11.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["htmlwidgets"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["plotly"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["4.11.0"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105]}},"value":[{"type":"character","attributes":{},"value":["abind","base","base64enc","bslib","cachem","class","classInt","cli","codetools","colorspace","cols4all","compiler","crosstalk","data.table","datasets","DBI","dichromat","digest","dplyr","DT","e1071","evaluate","farver","fastmap","forcats","generics","ggplot2","glue","graphics","grDevices","grid","gtable","hms","htmltools","htmlwidgets","httpuv","httr","jquerylib","jsonlite","KernSmooth","knitr","later","lattice","lazyeval","leafem","leaflegend","leaflet","leaflet.providers","leafsync","lifecycle","logger","lubridate","lwgeom","magrittr","maptiles","memoise","methods","mime","parallel","pillar","pkgconfig","plotly","png","promises","proxy","purrr","R6","raster","RColorBrewer","Rcpp","readr","rlang","rmarkdown","rstudioapi","s2","sass","scales","sf","shiny","sp","spacesXYZ","stars","stats","stringi","stringr","terra","tibble","tidyr","tidyselect","tidyverse","timechange","tmap","tmaptools","tools","tzdb","units","utils","vctrs","viridisLite","withr","wk","xfun","XML","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.4-8","4.5.1","0.1-3","0.9.0","1.1.0","7.3-23","0.4-11","3.6.5","0.2-20","2.1-1","0.8","4.5.1","1.2.2","1.17.8","4.5.1","1.2.3","2.0-0.1","0.6.37","1.1.4","0.33","1.7-16","1.0.5","2.1.2","1.2.0","1.0.0","0.1.4","3.5.2","1.8.0","4.5.1","4.5.1","4.5.1","0.3.6","1.1.3","0.5.8.1","1.6.4","1.6.16","1.4.7","0.1.4","2.0.0","2.23-26","1.50","1.4.4","0.22-7","0.2.2","0.2.4","1.2.1","2.2.2","2.0.0","0.1.0","1.0.4","0.4.0","1.9.4","0.2-14","2.0.3","0.10.0","2.0.1","4.5.1","0.13","4.5.1","1.11.0","2.0.3","4.11.0","0.1-8","1.3.3","0.4-27","1.1.0","2.6.1","3.6-32","1.1-3","1.1.0","2.1.5","1.1.6","2.29","0.17.1","1.1.9","0.4.10","1.4.0","1.0-21","1.10.0","2.2-0","1.6-0","0.6-8","4.5.1","1.8.7","1.5.1","1.8-60","3.3.0","1.3.1","1.2.1","2.0.0","0.3.0","4.1","3.2","4.5.1","0.5.0","0.8-7","4.5.1","0.6.5","0.4.2","3.0.2","0.9.4","0.53","3.99-0.18","1.8-4","2.3.10"]}]}]}
</script>
<!--/html_preserve-->


<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /container fluid -->

<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (_event) {
  if (window.bslib.Card) {
    window.bslib.Card.initializeAllCards();
  }
}); 
</script>
  



</body></html>